/*! 29.0.1.0 */
/*! VersionVI: 01A302032    */
function WDVignette(n,t,i,r,u){if(arguments.length){WDImage.prototype.constructor.apply(this,arguments);var f=u[2],e=u[3];f?(this.m_bCelluleUtilisateur=!0,this.m_sAliasCellule=f,this.m_sAliasGrandeImage=e):(this.m_bCelluleUtilisateur=!1,this.m_sAliasCellule=n+this.ms_sSuffixeHote,this.m_sAliasGrandeImage=n+this.ms_sSuffixeGrandeImage)}}WDVignette.prototype=new WDImage;WDVignette.prototype.constructor=WDVignette;WDVignette.prototype.ms_sSuffixeGrandeImage="_DIMG";WDVignette.prototype.Init=function(){if(WDImage.prototype.Init.apply(this,arguments),!this.m_bCelluleUtilisateur){var n=this;this.m_fChargementTermine=function(t){n.__ChargementTermine(t||event)}}};WDVignette.prototype._vLiaisonHTML=function(){WDImage.prototype._vLiaisonHTML.apply(this,arguments);this.m_oCellule=document.getElementById(this.m_sAliasCellule);this.m_oGrandeImage=document.getElementById(this.m_sAliasGrandeImage)};WDVignette.prototype._vOnResize=function(){WDImage.prototype._vOnResize.apply(this,arguments);this._bGrandeImageAffichee()};WDVignette.prototype._vbGetDefilementEffectif=function(){return WDImage.prototype._vbGetDefilementEffectif.apply(this,arguments)&&!this._bGrandeImageAffichee()};WDVignette.prototype._bGrandeImageAffichee=function(){return this.m_oGrandeImage?clWDUtil.bEstDisplay(this.m_oGrandeImage,document,!0):!1};WDVignette.prototype.__PrepareGrandeImage=function(){if(!this.m_bCelluleUtilisateur){var n=this.m_oGrandeImage;UnhookOnXXX(n,"onreadystatechange","load",this.m_fChargementTermine);this.m_oGrandeImage=document.createElement("img");n=n.parentNode.replaceChild(this.m_oGrandeImage,n)}};WDVignette.prototype.__AfficheGrandeImage=function(n){this.m_bCelluleUtilisateur||(HookOnXXX(this.m_oGrandeImage,"onreadystatechange","load",this.m_fChargementTermine),this.m_oCellule.style.visibility="hidden");this.m_oGrandeImage.src=n};WDVignette.prototype.__ChargementTermine=function(){var f=Math.min(document.body.scrollWidth,document.body.clientWidth)-60,e=Math.min(document.body.scrollHeight,document.body.clientHeight)-60,n=Math.max(this.m_oGrandeImage.offsetWidth,1),t=Math.max(this.m_oGrandeImage.offsetHeight,1),o=Math.max(n-f,0),s=Math.max(t-e,0),i=o/n,r=s/t,u=!1;i>r?(u=!0,n=f,t=t*(1-i)):i<r&&(u=!0,t=e,n=n*(1-r));u&&(this.m_oGrandeImage.style.width=n+"px",this.m_oGrandeImage.style.height=t+"px");this.nSetTimeout(this.__ChargementTermineRecentre,clWDUtil.ms_oTimeoutImmediat)};WDVignette.prototype.__ChargementTermineRecentre=function(){clWDUtil.RecentreDialogue(this.m_sAliasCellule);clWDUtil.SetDisplay(this.m_oCellule,!0);this.m_oCellule.style.visibility="inherit"};WDVignette.prototype.__FermeGrandeImage=function(){this.m_bCelluleUtilisateur||(this.m_oGrandeImage.style.src="",this.m_oGrandeImage.style.width="1px",this.m_oGrandeImage.style.height="1px",clWDUtil.SetDisplay(this.m_oCellule,!1));window.$&&$(document.body).removeClass("wbOverflowHidden");this.__PostFermeGrandeImage()};WDVignette.prototype.sSetOnclickLienParent=function(n,t){var i=this;return n.onclick=null,n.onclick=function(){i.ImageAffiche(t)},t};WDVignette.prototype.ImageAffiche=function(n,t,i,r){var f,u,e;if(t&&i&&r&&!this.m_bCelluleUtilisateur&&$(i).closest(".wbGalerie").hasClass("wbGaleriePleinEcranClicFond")){i.wbGalerieClicVignetteEnCours=n;return}if(this.__PrepareGrandeImage(),clWDUtil.CelluleAfficheDialogue(this.m_sAliasCellule,document,5,_GFI_A_,_GFI_T_,undefined,undefined,!0,undefined,this.ImageFerme.bind(this)),f=clWDUtil.GetCelluleDialogue(this.m_sAliasCellule),f&&window.$){$(document.body).addClass("wbOverflowHidden");f.m_bDisplayNone=!0;u=f.m_oCellule;e=f.m_oCelluleGFI;$(u).addClass("wbVignetteAvantAffichage");setTimeout(function(){$(u).removeClass("wbVignetteAvantAffichage").addClass("wbVignetteAffichageOK")},10);$(e).hide().fadeIn();$(f.m_oCellule).one("trigger.wb.effet.apparition.masque",function(n,t){return $(u).fadeOut().removeClass("wbVignetteAffichageOK"),$(e).fadeOut(function(){t&&t.fCallback&&(this.__FermeGrandeImage(),t.fCallback())}.bind(this)),!0}.bind(this));!this.m_bCelluleUtilisateur&&u.firstElementChild&&u.firstElementChild.classList&&u.firstElementChild.classList.contains("wbVignettePopupAutoOutils")&&function(){function l(){var o,s;if(n<=1)n=1,r=f=0,t();else{var u=i.getBoundingClientRect(),h=u.left-e.left,c=window.innerWidth-(u.right+e.right);h>0!=c>0&&(Math.abs(h)<Math.abs(c)?(r-=(u.left-e.left)/n,t()):(r-=(u.right+e.right-window.innerWidth)/n,t()));o=u.top-e.top;s=window.innerHeight-(u.bottom+e.bottom);o>0!=s>0&&(Math.abs(o)<Math.abs(s)?(f-=(u.top-e.top)/n,t()):(f-=(u.bottom+e.bottom-window.innerHeight)/n,t()))}}function t(){s&&cancelAnimationFrame(s);p?(i.style.cursor="grabbing",i.style.transition="none"):(i.style.cursor="grab",i.style.transition="transform 150ms ease-out");n<=1?v.attr("disabled","disabled"):v.removeAttr("disabled");s=requestAnimationFrame(function(){s=0;i.style.transform=" scale("+n+","+n+") translateX("+r+"px) translateY("+f+"px) rotateZ("+c+"deg)"})}var a=$(u.firstElementChild),v=a.children().eq(1),y=$(u),p=!1,n=1,r=0,f=0,c=0,e={left:0,right:0,bottom:0,top:0},o=$(this.m_oGrandeImage),i,h,s;o.parent().get(0).tagName.toLowerCase()==="td"&&(o=o.closest("table"));i=o.get(0);i.style.userSelect="none";i.style.overflow="hidden";t();a.click(function(n){n.stopPropagation()});o.on("mousedown",function(n){n.preventDefault()});y.on("click.wb.vignetteauto.ferme",function(n){n.target===u&&this.ImageFerme()}.bind(this));(function(){var u=null;$(window).on("touchstart.noPreventDefault touchmove.noPreventDefault touchend.noPreventDefault touchcancel.noPreventDefault",function(n){(n.type==="touchmove"||$(n.target).closest(i).length)&&n.preventDefault()}).swipe({pinchStatus:function(e,o,s,h,c,a,v,y){if(p=!(o==="end"||o==="cancel"),o==="start"&&(u={translation:{x:r,y:f},zoom:n}),v=e.scale||v,a<2){if(o==="end"||o==="cancel")u=null,l();else if($(e.target).closest(i).length){if(!u)return;var w={x:nGetPageX(e),y:nGetPageY(e)},b=n<=1?.1:1;r=u.translation.x+b*(w.x-y[0].start.x)/n;f=u.translation.y+b*(w.y-y[0].start.y)/n;t()}return}if(a==2&&s){if(o=="end"||o=="cancel"){l();return}n=v*u.zoom;t()}},tap:function(){},doubleTap:function(i){$(i.target).closest(".wbVignettePopupAutoOutils").length||(n=n===1?2.5:1,r=f=0,t())},preventDefaultEvents:!1,excludedElements:"label, button, input, select, textarea, .noSwipe"})})();h=null;$(window).on("wheel",function(i){n=Math.max(.9,n-nGetDeltaY(i,0)/100);r=f=0;t();clearTimeout(h);n<1&&(h=setTimeout(function(){l();clearTimeout(h)},150))});s=0;this.ImageAvance=function(){n=Math.max(n+1,1);t()};this.ImageRecule=function(){n=Math.max(n-1,1);t()};this.ImageTourne=function(){c=c+90;r=f=0;t()};this.__PostFermeGrandeImage=function(){o.off();$(window).off("touchstart.noPreventDefault touchmove.noPreventDefault touchend.noPreventDefault touchcancel.noPreventDefault wheel");y.off("click.wb.vignetteauto.ferme")}}.bind(this)()}this.__AfficheGrandeImage(n)};WDVignette.prototype.ImageFerme=function(){clWDUtil.CelluleFermeDialogue(this.m_sAliasCellule)};WDVignette.prototype.ImageAvance=function(){};WDVignette.prototype.ImageRecule=function(){};WDVignette.prototype.ImageTourne=function(){};WDVignette.prototype.__PostFermeGrandeImage=function(){}