/*! 29.0.2.0 */
/*! VersionVI: 01A302032    */
function WDAJAXRequete(n,t,i,r){this.m_nId=n;this.m_clRequete=t;this.m_bPost=i;this.m_bSynchrone=r;this.m_bValide=!0;this.m_bJSONExterne=!1}function _JAEE(n,t,i,r,u,f){clWDAJAXMain.AJAXExecuteEvenement(n,t,i,r,u,f)}function _JAZR(n,t){clWDAJAXMain.SetZRChamp(n,t)}function _JAZREDE(n,t,i,r){clWDAJAXMain.SetZRChampEnrouleDeroule(n,t,i,r)}WDAJAXRequete.prototype.sHeaderErreur="WebDevError";WDAJAXRequete.prototype.sHeaderRedirPHP="WebDevRedirPHP";WDAJAXRequete.prototype.sHeaderXML="WebDevXMLDoc";WDAJAXRequete.prototype.OnReadyState=function(n){var i;if(this.m_clRequete&&XMLHttpRequest.DONE===this.m_clRequete.readyState){if(i=!1,this.bValideResultat())if(this.m_oObjetRequeteTable)switch(clWDAJAXMain.eReponseGenerique(this,n,this.m_oObjetRequeteTable,[])){case 0:i=!1;break;case 1:case 2:i=!0}else if(this.m_fCallback){var t=this.m_fCallback,r=this.sGetResultat(n),u=t.nNbParametres,f=undefined!==u?u:t.length;switch(f){case 0:t();break;case 1:t(r);break;default:t(r,this.m_nId)}}this.m_oObjetRequeteTable&&this.m_oObjetRequeteTable.SupprimeRequete(!i);this.Libere()}};WDAJAXRequete.prototype.__bHeaderHTTPExiste=function(n){try{var t=this.m_clRequete.getResponseHeader(n);return t&&t.length>0}catch(i){return!1}};WDAJAXRequete.prototype.bRedirectionPHP=function(){return this.__bHeaderHTTPExiste(this.sHeaderRedirPHP)};WDAJAXRequete.prototype.bErreurServeur=function(){return this.__bHeaderHTTPExiste(this.sHeaderErreur)};WDAJAXRequete.prototype.xEnvoi=function(n,t){!this.m_bPost&&n.length>0&&(t+=(t.indexOf("?")==-1?"?":"&")+n);this.m_bValide=!1;try{this.m_clRequete.open(this.m_bPost?"POST":"GET",t,!this.m_bSynchrone);this.m_clRequete.setRequestHeader("Content-Type","application/x-www-form-urlencoded");this.m_clRequete.send(this.m_bPost?n:"")}catch(i){throw new WDErreur(500,i.message);}};WDAJAXRequete.prototype.sGetDocRequeteAlphabet=function(){var t=document.charset,n;if(!t)return undefined;try{if(n=this.m_clRequete.getResponseHeader("Content-type"),n&&0<n.indexOf("charset="))return n.substring(n.indexOf("charset=")+8)}catch(i){}return t};WDAJAXRequete.prototype.bValideResultat=function(){var n,r,u,t,i;if((this.m_bValide=!1,XMLHttpRequest.DONE!==this.m_clRequete.readyState)||(n=this.m_clRequete.status,0===n))return!1;if(!this.m_bJSONExterne){if(this.bRedirectionPHP())return r=this.m_clRequete.responseText,document.location.replace(decodeURI(r)),!1;if(this.bErreurServeur())return u=this.m_clRequete.responseText,t=this.sGetDocRequeteAlphabet(),this.Libere(),clWDAJAXMain.s_BloqueAJAX(),i=document,clWDUtil.nSetTimeout(function(){i.write(u);t&&(i.charset=t);document.close()},clWDUtil.ms_oTimeoutImmediat),!1}return 400<=n?!1:(this.m_bValide=!0,!0)};WDAJAXRequete.prototype.sGetResultat=function(n){var i,r,t;if(this.m_bValide){if(i=this.m_clRequete.responseText,i.substring(0,5)==="<?xml"&&i.match(clWDAJAXMain.XML_RACINERegExp))return r=[],clWDAJAXMain.eReponseGenerique(this,n,null,r),r.length?r[0]:"";try{if(t=this.m_clRequete.getResponseHeader(this.sHeaderXML),t&&t.length>0)return XMLAjoutDoc(t,this.m_clRequete.responseXML),t}catch(u){}return i}return""};WDAJAXRequete.prototype.Init=function(n){if(!this.m_bSynchrone){this.m_oObjetRequeteTable=n;var t=this;this.m_clRequete.onreadystatechange=function(){t.OnReadyState(window._PAGE_)}}};WDAJAXRequete.prototype.bEnCours=function(){return!!this.m_fCallback};WDAJAXRequete.prototype.Annule=function(){delete this.m_fCallback;this.m_clRequete.onreadystatechange=clWDUtil.m_pfVide;this.Libere()};WDAJAXRequete.prototype.Libere=function(){clWDAJAXMain.SupprimeWDAJAXRequete(this.m_nId);this.m_oObjetRequeteTable=null;delete this.m_oObjetRequeteTable;this.m_clRequete&&(delete this.m_clRequete.onreadystatechange,bFF&&this.m_clRequete.readyState<XMLHttpRequest.DONE&&this.m_clRequete.abort(),delete this.m_clRequete);clWDAJAXMain.s_ReactualiseActivite(!1)};var clWDAJAXMain=function(){function o(n,t,i){clWDUtil.bForEach(n,function(n){var r=n.name;return n.type&&clWDAJAXMain.sCommandeWDAction!==r&&"PTH_"!==r.substr(0,4)&&i!==r&&t(n),!0})}function i(n,t){var i,f,r,u;if(n.type){switch(n.type.toLowerCase()){case"textarea":f=!0;case"text":case"hidden":case"password":i=n.value;n.bIndication===!0?i="":f&&(i=i.replace(d,"\r\n"));break;case"button":break;case"checkbox":case"radio":if(n.checked&&(i=n.value,Object.prototype.hasOwnProperty.call(t,n.name))){if(r=t[n.name],r instanceof Array)return r.push(i),t;i=[r,i]}break;case"select-one":n.selectedIndex!=-1&&(i=n.options[n.selectedIndex].value);break;case"select-multiple":u=[];clWDUtil.bForEach(n.options,function(n){return n.selected&&u.push(n.value),!0});u.length&&(i=u);break;case"file":case"reset":case"submit":break;default:i=n.value}undefined!==i&&(t[n.name]=i)}return t}function p(){return y++}function s(n,t){return n.m_nId===t}function w(){clWDAJAXMain.TraiteAJAXExecuteEvenement()}function e(){t&&(clWDUtil.DeplaceElement(t,document,c,undefined,undefined,!0),t.style.visibility=r?"inherit":"hidden")}function a(n,t,i,r){if(n.onclick){var u=l[t]||n.getAttributeNode("onclick").value;i.test(u)&&(u=u.replace(i,r),n.onclick=new Function("",u),l[t]=u)}}var y=1,n=[],u=0,f=!1,h=!0,t=null,r=!1,c=0,l={},b=new RegExp("[\\s]","g"),k=new RegExp("[\\r\\n\\t]","g"),v=new RegExp("[\\r\\n]","g"),d=/\n/g,g=new RegExp("\\s(\\s)+","g"),nt=new RegExp("\\(\\'([^\\']*)\\'","");return{m_tabRequetes:[],m_bPageAWP:document.location.pathname.substr(document.location.pathname.length-4,4).toLowerCase()==".awp",sCommandeAjax_Execute:"WD_ACTION_=AJAXEXECUTE",sCommandeAjax_Champ:"WD_ACTION_=AJAXCHAMP",sCommandeAjax_Page:"WD_ACTION_=AJAXPAGE",sCommandeAjax_Erreur:"WD_ACTION_=AJAXERREUR",sCommandeWDAction:"WD_ACTION_",sCommandeAjax_ExecuteProc:"EXECUTEPROC",sCommandeAjax_ExecuteProcSChamps:"CHAMPS",sCommandeAjax_ExecuteProcSNonExclusif:"_NE",sCommandeAjax_ExecuteProcSPOSTChamps:"_PC",sCommandeAjax_Evenement:"EXECUTE",sCommandeAjax_Reglette:"SCROLLTABLE",sCommandeAjax_ClicTable:"CLICTABLE",sCommandeAjax_ActionChamp:"ACTIONCHAMP",sCommandeAjax_SaisieAssistee:"SAISIEASSISTEE",sCommandeAjax_PlanDiffere:"PLANDIFFERE",sCommandeAjax_ImageInformations:"IMAGEINFORMATIONS",sCommandeAjax_Contexte:"WD_CONTEXTE_",sCommandeAjax_SynchroniseVariables:"WD_VARIABLES_",ms_oRegExpRC:v,ms_nAJAXExecuteDefaut:0,ms_nAJAXExecuteChamps:1,ms_nAJAXExecuteNonExclusif:2,ms_nAJAXExecuteSynchroniseVariables:4,ms_nAJAXExecutePOSTChamps:8,ms_nAJAXTypesStructures:16,ms_nAJAXExecuteJSONExterne:1073741824,XML_RACINE:"WAJAX",XML_RACINERegExp:new RegExp("<WAJAX>"),XML_JS:"JS",XML_REDIR:"REDIR",XML_CHAMP:"CHAMP",XML_LISTE:"LISTE",XML_RESULTAT:"RESULTAT",XML_RESULTAT_FORMAT:"FORMAT",XML_TRACE:"TRACE",XML_TRACE_ID:"WDAJAX_TRACE",XML_LIENSOCIAL:"LIENSOCIAL",XML_LIENSOCIAL_FACEBOOK:1,XML_LIENSOCIAL_TWEETER:2,XML_LIENSOCIAL_LINKEDIN:8,XML_VARSYNC:"VARSYNC",XML_GALERIESIDS:"GALERIESIDS",XML_CHAMP_ATT_ALIAS:"ALIAS",XML_CHAMP_ATT_TYPE:"TYPE",XML_CHAMP_TYPE_PAGEPRINCIPALE:1,XML_CHAMP_TYPE_SELECTEUR:6,XML_CHAMP_TYPE_LISTE:7,XML_CHAMP_TYPE_TABLE:9,XML_CHAMP_TYPE_CHAMPFORMATE:10,XML_CHAMP_TYPE_ZONEREPETEE:11,XML_CHAMP_TYPE_HTML:12,XML_CHAMP_TYPE_LIEN:16,XML_CHAMP_TYPE_LIBELLEHTML:17,XML_CHAMP_TYPE_WEBCAM:20,XML_CHAMP_TYPE_REGLETTE:21,XML_CHAMP_TYPE_MAPAREA:22,XML_CHAMP_TYPE_CHEMINNAV:23,XML_CHAMP_TYPE_TREEVIEW:25,XML_CHAMP_TYPE_VIGNETTE:26,XML_CHAMP_TYPE_IFRAME:27,XML_CHAMP_TYPE_IFRAME_DEST:31,XML_CHAMP_TYPE_IFRAME_SOURCE:32,XML_CHAMP_TYPE_GRAPHE:33,XML_CHAMP_TYPE_TIROIR:34,XML_CHAMP_TYPE_TABLEHIERARCHIQUE:35,XML_CHAMP_TYPE_SUPERCHAMP:40,XML_CHAMP_TYPE_MODELEDECHAMP_SOURCE:42,XML_CHAMP_TYPE_MODELEDECHAMP_DEST:43,XML_CHAMP_TYPE_ONGLET:44,XML_CHAMP_TYPE_PLANSITE:45,XML_CHAMP_TYPE_CALENDRIER:47,XML_CHAMP_TYPE_VOLETONGLET:49,XML_CHAMP_TYPE_SOUSMENU:55,XML_CHAMP_TYPE_COLONNETABLE:56,XML_CHAMP_TYPE_OPTIONMENU:57,XML_CHAMP_TYPE_COLONNETABLEH:68,XML_CHAMP_TYPE_RANGESLIDER:72,XML_CHAMP_TYPE_AGENDA:76,XML_CHAMP_TYPE_ZONEREPETEEHORIZONTALE:77,XML_CHAMP_TYPE_VIDEO:78,XML_CHAMP_TYPE_PAGECORNEE:79,XML_CHAMP_TYPE_PLANNING:80,XML_CHAMP_TYPE_CAPTCHA:82,XML_CHAMP_TYPE_JAUGE:83,XML_CHAMP_TYPE_CELLULEMISEENPAGE:84,XML_CHAMP_TYPE_RATING:85,XML_CHAMP_TYPE_POPUP:90,XML_CHAMP_TYPE_CARTE:92,XML_CHAMP_TYPE_POTENTIOMETRE:100,XML_CHAMP_TYPE_TCD:102,XML_CHAMP_TYPE_LIENSOCIAL:103,XML_CHAMP_TYPE_MENUPOPUP:105,XML_CHAMP_TYPE_ZONETEXTE:109,XML_CHAMP_TYPE_TABLEAUDEBORD:111,XML_CHAMP_TYPE_BARRENAVIGATION_CELL:115,XML_CHAMP_TYPE_BARRENAVIGATION:117,XML_CHAMP_TYPE_BANDEAU_DEFILANT:122,XML_CHAMP_TYPE_EDITEUR_IMAGE:124,XML_CHAMP_TYPE_DISPOSITION_CELLULE:127,XML_CHAMP_TYPE_EDITEUR_DIAGRAMME:130,XML_CHAMP_TYPE_CELLULE_FLEXBOX:139,XML_CHAMP_TYPE_CHAMPKANBAN:140,XML_CHAMP_TYPE_EDITEURCODEWL:146,XML_CHAMP_ETAT_ETAT:"ETAT",XML_CHAMP_JS:"JS",XML_CHAMP_LIGNES:"LIGNES",XML_CHAMP_LIGNES_COLONNES:"COLONNES",XML_CHAMP_LIGNES_DATA:"DATA",XML_CHAMP_LIGNES_DEBUT:"DEBUT",XML_CHAMP_LIGNES_LIGNE:"LIGNE",XML_CHAMP_LIGNES_LIGNE_CORPS:"CORPS",XML_CHAMP_LIGNES_LIGNE_DEBUT:"DEBUT",XML_CHAMP_LIGNES_LIGNE_FIN:"FIN",XML_CHAMP_LIGNES_LIGNE_INDICE:"INDICE",XML_CHAMP_LIGNES_LIGNE_INVISIBLE:"INVISIBLE",XML_CHAMP_LIGNES_LIGNE_REPLIEE:"REPLIEE",XML_CHAMP_LIGNES_LIGNE_STYLE:"STYLE",XML_CHAMP_LIGNES_NBREPLIEES:"NBREPLIEES",XML_CHAMP_LIGNES_NOMBRE:"NOMBRE",XML_CHAMP_LIGNES_RUPTURES:"RUPTURES",XML_CHAMP_LIGNES_SELECTION:"SELECTION",XML_CHAMP_LIGNES_STYLE:"STYLE",XML_CHAMP_OPTIONS:"OPTIONS",XML_CHAMP_OPTIONS_OPTION:"OPTION",XML_CHAMP_OPTIONS_OPTION_COCHE:"COCHE",XML_CHAMP_OPTIONS_OPTION_HTML:"HTML",XML_CHAMP_PROP:"PROP",XML_CHAMP_PROP_ATT_NUM:"NUM",XML_CHAMP_PROP_NUM_LIBELLE_TABLE_AJAX:"TABLE_AJAX",XML_CHAMP_PROP_NUM_VISIBLE_PARENTRELATIF:"PARENTRELATIF",XML_CHAMP_PROP_NUM_VISIBLE_PARENTFLUX:"PARENTFLUX",XML_CHAMP_RECHARGE:"RECHARGE",XML_CHAMP_RECHARGE_PARAM:"PARAM",XML_CHAMP_REFRESH:"REFRESH",XML_CHAMP_REFRESH_DATA:"DATA",XML_CHAMP_REFRESH_DEBUT:"DEBUT",XML_CHAMP_REFRESH_NOMBRE:"NOMBRE",XML_CHAMP_REFRESH_RESETTABLE:"RESETTABLE",XML_CHAMP_REFRESH_TRI:"TRI",XML_CHAMP_REFRESH_SENS:"SENS",XML_CHAMP_SAISIEA:"SAISIEA",XML_CHAMP_SAISIEA_FILTRE:"FILTRE",XML_CHAMP_SAISIEA_OUVERTUREAUTO:"OUVERTUREAUTO",XML_CHAMP_SAISIEA_TAILLEMIN:"TAILLEMIN",XML_CHAMP_SAISIEA_DELAI:"DELAI",XML_CHAMP_SAISIEA_SANSCASSE:"SANSCASSE",XML_CHAMP_SAISIEA_OPTION:"OPTION",XML_CHAMP_SAISIEA_SANSOPTION:"SANSOPTION",XML_CHAMP_SAISIEAJETON:"SAISIEAJETON",XML_CHAMP_SAISIEMASQUE:"SAISIEMASQUE",XML_CHAMP_SATURATION:"SATURATION",XML_CHAMP_TREEVIEW:"TREEVIEW",XML_CHAMP_TREEVIEW_DEROULE:"DEROULE",XML_CHAMP_TREEVIEW_DEROULETAB:"DEROULETAB",XML_CHAMP_TREEVIEW_NOEUDS:"NOEUDS",XML_CHAMP_TREEVIEW_SELECT:"SELECT",XML_WBTRACE_ID:"WB_TRACE",bWDAJAXMainValide:function(){if(!this.m_bChargementTermine){if(document.readyState&&document.readyState!="interactive"&&document.readyState!="complete")return!1;if(this.m_bChargementTermine=!0,bFF){var n=new RegExp("Fire[Ff]ox/\\s*(\\d+)\\.*(\\d+)").exec(navigator.userAgent);(!n||!n[1]||parseInt(n[1],10)<27)&&clWDUtil.AttacheDetacheEvent(!0,window,"beforeunload",this.s_BloqueAJAX,!0)}}return h},s_BloqueAJAX:function(){for(t=null,r=!1,h=!1;0<n.length;)n[0].Libere()},clCreeWDAJAXRequete:function(t,i,r){t==null&&(t=!0);i==null&&(i=!1);var f=new XMLHttpRequest,u=new WDAJAXRequete(p(),f,t,i);return u.Init(r),i||n.push(u),u},GetWDAJAXRequete:function(t){return clWDUtil.oDansTableauFct(n,s,t,null)},SupprimeWDAJAXRequete:function(t){clWDUtil.SupprimeDansTableauFct(n,s,t)},eReponseGenerique:function(n,t,i,r){return n.bValideResultat()?this.__eReponseGenerique(n,t,i,n.m_clRequete.responseText,n.m_clRequete.responseXML,n.sGetDocRequeteAlphabet(),r):0},oGetXMLDepuisTexte:function(n){if(n&&n.length&&window.DOMParser){var t=new DOMParser;if(t)return t.parseFromString(n,"text/xml")}return null},eReponseGeneriqueDepuisTexte:function(n,t,i){var r=this.oGetXMLDepuisTexte(n);return r?this.__eReponseGenerique(null,t,null,n,r,document.charset,i):0},bValideEtTraiteErreur:function(n,t,i){var u,r;return t.substring(0,5)=="<?xml"&&t.match(this.XML_RACINERegExp)?!0:(u=t,n&&(n.Libere(),n=null),this.s_BloqueAJAX(),r=document,clWDUtil.nSetTimeout(function(){r.write(u);i&&(r.charset=i);r.close()},clWDUtil.ms_oTimeoutImmediat),!1)},__eReponseGenerique:function(n,t,i,r,u,f,e){return this.bValideEtTraiteErreur(n,r,f)?this.eActionXML(t,i,u,e):1},sConstruitValeurChampNom:function(n,t,r){var u={},e=this.__oChercheChamp(n,t),f;return e&&i(e,u),r&&(f=n.WD_JSON_PROPRIETE_,f&&i(f,u)),this.sConstruitValeursChamps(u)},sConstruitValeursChamps:function(n){var t=[];return clWDUtil.bForEachIn(n,function(n,i){function r(i){return t.push(encodeURIComponent(n)+"="+encodeURIComponent(i)),!0}return i instanceof Array?clWDUtil.bForEach(i,r):r(i),!0}),t.join("&")},sConstruitValeurChamp:function(n){return this.sConstruitValeursChamps(i(n,{}))},sConstruitValeurPage:function(n,t){var i=[];return o(n,function(n){for(var t=clWDAJAXMain.sConstruitValeurChamp(n);"&"===t.charAt(t.length-1);)t=t.substr(0,t.length-1);t.length&&i.push(t)},t),i.join("&")},oCompleteValeurPage:function(n,t,r){return o(n,function(n){i(n,t)},r),t},sConstruitURL:function(n){return n},sConstuitRequeteTable:function(n){var t=this.sCommandeAjax_Execute;return n.length>0&&(t+="&"+n),t},sConstuitURLRequeteJauge:function(n){var i=this.sConstruitURL(clWDUtil.sGetPageAction()),t=i.split("?");return t[0]+="/JAUGE/"+document.forms[0].name+"."+n,t.join("?")},SetZRChamp:function(n,t){if(this.m_sZRChamp){f=!0;return}this._SetZRChamp(n,t)},SetZRChampEnrouleDeroule:function(n,t,i,r){this.m_sZRChamp||this.m_nRupture||(this._SetZRChamp(t,""+i),this.m_nRupture=r,this.AJAXExecuteEvenement(n,t,"ENDETABLE",10,undefined))},_SetZRChamp:function(n,t){this.m_sZRChamp=n;this.m_sZRChampValeur=t},sConstuitRequeteEvenement:function(n,t,i,r,u){var f=[],e="",l=t,o,h,s,c;undefined!==t&&t.length&&0<t.indexOf(";")&&(o=t.split(";"),1<o.length&&o[0].length&&o[1].length&&(t=o[0],l=o[1]));window.NSPCS&&NSPCS.NSChamps.ms_oSynchronisationServeur.OnSubmit();switch(r){case 1:f.push(this.sCommandeAjax_Champ);f.push(this.sCommandeAjax_Evenement+"="+i);f.push(this.sCommandeAjax_Contexte+"="+t);e=this.sConstruitValeurChampNom(n,t,!0);this.m_sZRChamp&&f.push(encodeURIComponent(this.m_sZRChamp)+"="+encodeURIComponent(this.m_sZRChampValeur));break;case 2:f.push(this.sCommandeAjax_Page);f.push(this.sCommandeAjax_Evenement+"="+i);f.push(this.sCommandeAjax_Contexte+"="+t);this.m_sZRChamp&&f.push(encodeURIComponent(this.m_sZRChamp)+"="+encodeURIComponent(this.m_sZRChampValeur));e=this.sConstruitValeurPage(n.elements,this.m_sZRChamp);break;case 3:f.push(this.sCommandeAjax_Execute);f.push(this.sCommandeAjax_Reglette+"="+t);f.push(t+"="+i);break;case 4:f.push(this.sCommandeAjax_Page);f.push(this.sCommandeAjax_Reglette+"="+t);h=n[t];h&&(h.value=i);e=this.sConstruitValeurPage(n.elements);break;case 5:f.push(this.sCommandeAjax_Page);f.push(this.sCommandeAjax_ClicTable+"="+t);e=this.sConstruitValeurPage(n.elements);break;case 6:f.push(this.sCommandeAjax_Champ);f.push(this.sCommandeAjax_ClicTable+"="+t);e=this.sConstruitValeurChampNom(n,l,!0);break;case 8:f.push(this.sCommandeAjax_Champ);f.push(this.sCommandeAjax_ActionChamp+"="+(i?i:""));f.push(this.sCommandeAjax_Contexte+"="+t);e=this.sConstruitValeurChampNom(n,t,!0);s=oGetObjetChamp(t);f.push(this.sConstruitValeurChamp(s.oGetElementHTMLValeur()));f.push(this.sConstruitValeurChamp(s.oGetElementHTMLMois()));s.bGestionTableZR_SansPopup()&&f.push(this.sConstruitValeurChampNom(n,s.m_sAliasTableZRParent,!1));break;case 9:f.push(this.sCommandeAjax_Champ);f.push(this.sCommandeAjax_ActionChamp+"="+(i?i:""));f.push(this.sCommandeAjax_Contexte+"="+t);e=this.sConstruitValeurChamp(oGetObjetChamp(t).m_oChampFormulaire);break;case 10:if(undefined!=this.m_nRupture)f.push(this.sCommandeAjax_Champ),f.push(this.sCommandeAjax_ActionChamp+"="+(i?i:"")),f.push(this.sCommandeAjax_Contexte+"="+t),f.push("WD_PARAM_="+this.m_nRupture),f.push(encodeURIComponent(this.m_sZRChamp)+"="+encodeURIComponent(this.m_sZRChampValeur)),e=this.sConstruitValeurChampNom(n,this.m_sZRChamp+"_DATA",!0);else return"";break;case 11:f.push(this.sCommandeAjax_Champ);f.push(this.sCommandeAjax_SaisieAssistee+"="+t);e=this.sConstruitValeurChampNom(n,t,!0);break;case 12:window.NSPCS&&(f.push(this.sCommandeAjax_Champ),f.push(this.sCommandeAjax_ActionChamp+"="+i),f.push(this.sCommandeAjax_Contexte+"="+t),e=this.sConstruitValeurChampNom(n,NSPCS.NSChamps.ms_oSynchronisationServeur.m_oChamp.name,!0));break;case 13:f.push(this.sCommandeAjax_Champ);f.push(this.sCommandeAjax_ActionChamp+"="+i);f.push(this.sCommandeAjax_Contexte+"="+t);e=this.sConstruitValeurChampNom(n,t,!0);break;case 14:window.NSPCS&&(f.push(this.sCommandeAjax_Page),f.push(this.sCommandeAjax_PlanDiffere+"="+i),f.push(this.sCommandeAjax_Contexte+"="+t),e=this.sConstruitValeurPage(n.elements));break;case 15:window.NSPCS&&(f.push(this.sCommandeAjax_Execute),f.push(this.sCommandeAjax_ImageInformations+"="),clWDUtil.bForEachIn(i,function(n,t){return f.push("II_"+n+"="+encodeURIComponent(JSON.stringify(t))),!0}));break;case 16:f.push(this.sCommandeAjax_Page);f.push(this.sCommandeAjax_ActionChamp+"="+i);f.push(this.sCommandeAjax_Contexte+"="+t);e=this.sConstruitValeurPage(n.elements);break;case 17:f.push(this.sCommandeAjax_Champ);f.push(this.sCommandeAjax_ActionChamp+"="+(i?i:""));f.push(this.sCommandeAjax_Contexte+"="+t);c={};c[t]="object"==typeof u?JSON.stringify(u):String(u);e=this.sConstruitValeursChamps(c);break;default:this.m_sZRChamp&&(e=encodeURIComponent(this.m_sZRChamp)+"="+encodeURIComponent(this.m_sZRChampValeur));f.push(e!=""?this.sCommandeAjax_Champ:this.sCommandeAjax_Execute);f.push(this.sCommandeAjax_Evenement+"="+i);f.push(this.sCommandeAjax_Contexte+"="+t)}return e!==undefined&&e.length>0&&f.push(e),delete this.m_sZRChamp,delete this.m_sZRChampValeur,delete this.m_nRupture,typeof FinSubmitAJAX=="function"&&FinSubmitAJAX(),f.join("&")},AJAXDisponible:function(){return this.m_bAJAXDisponible===undefined&&(this.m_bAJAXDisponible=!!new XMLHttpRequest),this.m_bAJAXDisponible},sXMLGetValeur:function(n){var t,u,i,f,r;if(n){if(u=n.childNodes,i=u.length,i==1)return t=u[0].nodeValue,t||"";if(i>1){for(f=new Array(i),r=0;r<i;r++)t=u[r].nodeValue,f[r]=t!==null?t:"";return f.join("")}}return""},nXMLGetValeur:function(n){return parseInt(this.sXMLGetValeur(n),10)},bXMLGetValeur:function(n){return"0"!==this.sXMLGetValeur(n)},tabXMLGetTableauValeur:function(n,t){var i=[];return clWDUtil.bForEach(n.getElementsByTagName(t),function(n){return i.push(clWDAJAXMain.sXMLGetValeur(n)),!0}),0<i.length?i:null},bXMLAttributExiste:function(n,t){return!!n.attributes.getNamedItem(t)},sXMLGetAttribut:function(n,t){return n.attributes.getNamedItem(t).value},sXMLGetAttributSafe:function(n,t,i){var r=n.attributes.getNamedItem(t);return r?r.value:i},bXMLGetAttributSafe:function(n,t){return"1"===this.sXMLGetAttributSafe(n,t,"0")},bXMLGetAttributSafe_Vrai:function(n,t){return"0"===this.sXMLGetAttributSafe(n,t,"1")},nXMLGetAttribut:function(n,t){return parseInt(this.sXMLGetAttribut(n,t),10)},nXMLGetAttributSafe:function(n,t,i){var u=this.sXMLGetAttributSafe(n,t,""),r;return u.length>0&&(r=parseInt(u,10),!isNaN(r))?r:i},__sTrim:function(n,t,i){for(var e=new String(n),r,u=0,f;u<e.length;){if(r=e.charAt(u),t&&r==" "){u++;continue}if(i&&r=="\t"){u++;continue}if(t&&(r=="\r"||r=="\n")){u++;continue}break}for(f=e.length;f>u;){if(r=e.charAt(f-1),t&&r==" "){f--;continue}if(i&&r=="\t"){f++;continue}if(t&&(r=="\r"||r=="\n")){f++;continue}break}return e.substring(u,f)},sSupprimeEspacements:function(n){return n.replace(k,"").replace(g," ")},__oChercheChamp:function(n,t,i,r,u,f){var o,e;switch(i){case this.XML_CHAMP_TYPE_PAGEPRINCIPALE:return document.body;case this.XML_CHAMP_TYPE_WEBCAM:case this.XML_CHAMP_TYPE_IFRAME:if(o=this.__oChercheChampInterne(n,n.name+"_"+t,i,r,u,f),o)return o;if(!r&&!u&&(e=document.querySelectorAll("iframe[name$='_"+t+"']"),e&&1===e.length))return e[0]}return this.__oChercheChampInterne(n,t,i,r,u,f)},__oChercheChampInterne:function(n,t,i,r,u,f){var e;if(r){switch(i){case this.XML_CHAMP_TYPE_TABLE:case this.XML_CHAMP_TYPE_ZONEREPETEE:case this.XML_CHAMP_TYPE_TABLEHIERARCHIQUE:e=this.__oGetConteneurParent(t,i,!1,f||u);break;case WDChamp.prototype.ms_nIDObjetInterrupteur:t.substr(t.length-2,2)=="[]"&&(e=_JGE(t.substr(0,t.length-2),document,r));break;case this.XML_CHAMP_TYPE_CALENDRIER:u||(e=_JGE(t,document,!1,!0))}e||(e=_JGE(t,document,r))}else switch(i){case this.XML_CHAMP_TYPE_IFRAME_DEST:case this.XML_CHAMP_TYPE_IFRAME_SOURCE:case WDChamp.prototype.ms_nIDObjetCellule:case this.XML_CHAMP_TYPE_SUPERCHAMP:case this.XML_CHAMP_TYPE_MODELEDECHAMP_SOURCE:case this.XML_CHAMP_TYPE_MODELEDECHAMP_DEST:case this.XML_CHAMP_TYPE_CELLULEMISEENPAGE:case this.XML_CHAMP_TYPE_CELLULE_FLEXBOX:case WDChamp.prototype.ms_nIDObjetLibelle:case this.XML_CHAMP_TYPE_CHAMPFORMATE:case this.XML_CHAMP_TYPE_LIBELLEHTML:case this.XML_CHAMP_TYPE_ZONETEXTE:case this.XML_CHAMP_TYPE_REGLETTE:case this.XML_CHAMP_TYPE_CHEMINNAV:case this.XML_CHAMP_TYPE_PLANSITE:case this.XML_CHAMP_TYPE_SOUSMENU:case this.XML_CHAMP_TYPE_OPTIONMENU:case this.XML_CHAMP_TYPE_MENUPOPUP:e=_JGE(t,document,!1);break;case this.XML_CHAMP_TYPE_TREEVIEW:e=_JGE(t+"_",document,!1);break;case this.XML_CHAMP_TYPE_LIEN:case WDChamp.prototype.ms_nIDObjetBouton:case this.XML_CHAMP_TYPE_VOLETONGLET:case this.XML_CHAMP_TYPE_PAGECORNEE:case WDChamp.prototype.ms_nIDObjetImage:case this.XML_CHAMP_TYPE_MAPAREA:e=document.getElementById(t);clWDUtil.bBaliseEstTag(e,"i")&&(e=e.children[0])}if(e||(e=n[t]),!e&&(e=document.getElementsByName(t),e))switch(i){case this.XML_CHAMP_TYPE_SELECTEUR:break;default:e=e[0]}return e},__oGetConteneurParent:function(n,t,i,r){var f=t===this.XML_CHAMP_TYPE_ZONEREPETEEHORIZONTALE&&i,e=f?n+"_POS":"con-"+n,u;return r&&(u=document.getElementById("dww"+e)||document.getElementById("dww"+n)),u||(u=document.getElementById(e),f&&(u=u.getElementsByTagName("table")[0])),u||(u=document.getElementById("ctz"+n)),u},__oGetConteneurTBODY:function(n,t){var u=n,i,r,f;if(u&&clWDUtil.bBaliseEstTag(u,"table"))for(r=u.childNodes,f=r.length,i=0;i<f;i++)if(clWDUtil.bBaliseEstTag(r[i],"tbody")){if(u=r[i],t==this.XML_CHAMP_TYPE_ZONEREPETEEHORIZONTALE)for(r=u.childNodes,f=r.length,i=0;i<f;i++)if(clWDUtil.bBaliseEstTag(r[i],"tr")){u=r[i];break}break}return u},__oGetConteneurLigne:function(n,t,i){return this.__oGetRemonteFilsUnique(n+"_"+t,i)},__bEstTexteInactif:function(n){return n.nodeName!=="#text"?!1:0===n.nodeValue.replace(b,"").length},__bAvecFilsActifUnique:function(n){for(var i=!1,r=n.childNodes.length,t=0;t<r;t++)if(!this.__bEstTexteInactif(n.childNodes[t])){if(i)return!1;i=!0}return!0},__oGetRemonteFilsUnique:function(n,t){var r=document.getElementById(n),i;if(r&&t)for(i=r.parentNode;i&&i!=t&&this.__bAvecFilsActifUnique(i);)r=i,i=r.parentNode;return r},__bSupprimeLigne:function(n,t,i,r,u,f){var e=this.__oGetConteneurLigne(n,i,f);if(!e)return!1;switch(t){case this.XML_CHAMP_TYPE_TABLE:case this.XML_CHAMP_TYPE_ZONEREPETEE:this.__SupprimeRuptures(n,i,r,f)}return f?clWDUtil.oSupprimeElement(e):u.removeChild(e),this.__SupprimeStyleLigne(n,i),!0},__SupprimeStyleLigne:function(n,t){for(var i;(i=document.getElementById("rgs-"+n+"-"+t))&&i.parentNode;)i.parentNode.removeChild(i)},__oTrouveUneRupture:function(n,t,i,r,u){return this.__oGetRemonteFilsUnique(n+"-"+(t?"H":"B")+"-"+i+"-"+r,u)},__oTrouveRuptureExterne:function(n,t,i,r,u){for(var e,f=0;f<r;f++)if(e=this.__oTrouveUneRupture(n,t,f,i,u),e)return e;return null},__SupprimeUneRupture:function(n,t,i,r,u){clWDUtil.oSupprimeElement(this.__oTrouveUneRupture(n,t,i,r,u))},__SupprimeRuptures:function(n,t,i,r){for(var u=0;u<i;u++)this.__SupprimeUneRupture(n,!0,u,t,r),this.__SupprimeUneRupture(n,!1,u,t,r)},__RemplaceElementDansTable:function(n,t){n.parentNode.replaceChild(clWDUtil.oCreateContextualFragmentSelonElement(n,t),n)},__InsereElementDansTable:function(n,t){0<t.length&&n.parentNode.insertBefore(clWDUtil.oCreateContextualFragmentSelonElement(n,t),n)},__AjouteElementDansTable:function(n,t){var i,r;if(0<t.length)for(i=document.createRange(),i.setStart(n,0),r=clWDUtil.oCreateContextualFragment(i,t).childNodes;r.length>0;)n.appendChild(r[0])},__InsereRemplaceTrTdDansTable:function(n,t,i,r){var f,e,u;t=i?t+"<\/tr>":"<tr>"+t;f=clWDUtil.oCreateContextualFragmentSelonElement(n,t).childNodes;f.length>1&&(i?n.parentNode.insertBefore(f[0],n):n.parentNode.insertBefore(f[1],n.nextSibling));r?n.replaceChild(f[0].firstChild,r):i?n.parentNode.insertBefore(f[0],n):(e=n.previousSibling,u=f[0],clWDUtil.bBaliseEstTag(e,"tr")&&clWDUtil.bBaliseEstTag(u,"tr")?Array.prototype.forEach.call(u.children,function(n){e.appendChild(n)}):e.appendChild(u))},__bHTMLDebutTR:function(n){var t=n.substr(0,4).toLowerCase();return"<tr>"===t||"<tr "===t},__bHTMLDebutTD:function(n){var t=n.substr(0,4).toLowerCase();return"<td>"===t||"<td "===t},__oSauteTableCadrage:function(n){if(n&&clWDUtil.bBaliseEstTag(n,"table"))while(n&&!clWDUtil.bBaliseEstTag(n,"td"))n=n.children[0];return n},ActionProprieteValeur:function(n,t,i,r,u){var f=this.sXMLGetValeur(r),e,o,s;switch(i){case WDChamp.prototype.ms_nIDObjetImage:case this.XML_CHAMP_TYPE_MAPAREA:case this.XML_CHAMP_TYPE_VIGNETTE:case this.XML_CHAMP_TYPE_GRAPHE:case this.XML_CHAMP_TYPE_CAPTCHA:case this.XML_CHAMP_TYPE_IFRAME:n&&(n.src=f);break;case this.XML_CHAMP_TYPE_LISTE:n&&(n.selectedIndex=parseInt(f,10));break;case this.XML_CHAMP_TYPE_SELECTEUR:if(e=parseInt(f,10),e<0)if(n&&n.length)for(s=n.length,o=0;o<s;o++)n[o].checked=!1;else n&&(n.checked=!1);else n&&(n.length?e<=n.length&&(n[e].checked=!0):n.checked=!0);break;case WDChamp.prototype.ms_nIDObjetInterrupteur:n&&(n.checked=parseInt(f,10));break;case WDChamp.prototype.ms_nIDObjetLibelle:case this.XML_CHAMP_TYPE_CHAMPFORMATE:n=this.__oSauteTableCadrage(n);n&&(n.innerHTML=clWDUtil.sEncodeInnerHTML(f,!0));break;case WDChamp.prototype.ms_nIDObjetSaisie:n&&(n.value=f,clWDUtil.oAppelFonctionChamp(u,WDChamp.prototype.ms_sSetValeur,[null,f,n]));break;case this.XML_CHAMP_TYPE_HTML:case this.XML_CHAMP_TYPE_LIBELLEHTML:case this.XML_CHAMP_TYPE_ZONETEXTE:!n&&t&&(n=t);n=this.__oSauteTableCadrage(n);n&&(n.innerHTML=f);break;case this.XML_CHAMP_TYPE_REGLETTE:n=n.getElementsByTagName("ol")[0];case this.XML_CHAMP_TYPE_CHEMINNAV:case this.XML_CHAMP_TYPE_PLANSITE:n=this.__oSauteTableCadrage(n);n&&(n.innerHTML=f);break;case this.XML_CHAMP_TYPE_IFRAME_DEST:case this.XML_CHAMP_TYPE_IFRAME_SOURCE:case WDChamp.prototype.ms_nIDObjetCellule:case this.XML_CHAMP_TYPE_SUPERCHAMP:case this.XML_CHAMP_TYPE_MODELEDECHAMP_SOURCE:case this.XML_CHAMP_TYPE_MODELEDECHAMP_DEST:case this.XML_CHAMP_TYPE_CELLULEMISEENPAGE:case this.XML_CHAMP_TYPE_CELLULE_FLEXBOX:break;case this.XML_CHAMP_TYPE_ONGLET:case this.XML_CHAMP_TYPE_RANGESLIDER:case this.XML_CHAMP_TYPE_RATING:case this.XML_CHAMP_TYPE_POTENTIOMETRE:case this.XML_CHAMP_TYPE_BANDEAU_DEFILANT:clWDUtil.oAppelFonctionChamp(u,WDChamp.prototype.ms_sSetValeur,[null,f,null]);break;case this.XML_CHAMP_TYPE_TIROIR:clWDUtil.oAppelFonctionChamp(u,WDChamp.prototype.ms_sSetValeur,[null,parseInt(f,10)!=0,null]);break;case this.XML_CHAMP_TYPE_LIENSOCIAL:if(n&&n.attributes)switch(clWDUtil.sGetTagName(n)){case"a":n.setAttribute("href",f);break;case"div":f.length?n.setAttribute("data-href",f):n.attributes.getNamedItem("data-href")&&n.removeAttribute("data-href",0)}break;case this.XML_CHAMP_TYPE_EDITEUR_IMAGE:n&&(n.value=f,$(n).trigger("change"));break;default:n&&(n.value=f)}},ActionProprieteLibelle:function(n,t,i,r,u){var f=this.sXMLGetValeur(i),s,e,h,o,c,a,l;switch(t){case this.XML_CHAMP_TYPE_PAGEPRINCIPALE:document.title=f;return;case WDChamp.prototype.ms_nIDObjetBouton:e=_JGE("z_"+r+"_IMG",document,!1);e&&!clWDUtil.bBaliseEstTag(e,"img")?(h=e.getElementsByTagName("span"),h&&h.length&&(e=h[0]),s=e):n&&clWDUtil.bBaliseEstTag(n,"button")&&(s=n);s?s.innerHTML=clWDUtil.sEncodeInnerHTML(f,!u,u):n&&(n.value=f);return;case WDChamp.prototype.ms_nIDObjetLibelle:n=this.__oSauteTableCadrage(n);break;case this.XML_CHAMP_TYPE_LIBELLEHTML:case this.XML_CHAMP_TYPE_ZONETEXTE:n=this.__oSauteTableCadrage(n);n&&(n.innerHTML=f);return;case this.XML_CHAMP_TYPE_LIEN:if(n=_JGE(r,document,!1,!0)||clWDUtil.bBaliseEstTag(n,"a")&&n,n){while(n&&!clWDUtil.bBaliseEstTag(n,"a"))n=n.children[0];n&&(n.innerHTML=f)}return;case this.XML_CHAMP_TYPE_TABLE:case this.XML_CHAMP_TYPE_TABLEHIERARCHIQUE:n=document.getElementById("lz"+r);n||(n=_JGE(r,document,!1,!0));break;case this.XML_CHAMP_TYPE_COLONNETABLE:case this.XML_CHAMP_TYPE_COLONNETABLEH:o=new String(this.sXMLGetAttributSafe(i,this.XML_CHAMP_PROP_NUM_LIBELLE_TABLE_AJAX,""));o.length>0&&(c=o.indexOf(";"),a=oGetObjetChamp(o.substring(0,c)),n=a.oGetIDElement(clWDTableDefs.ID_TITRE,parseInt(o.substring(c+1),10)));n||(n=document.getElementById("tt"+r),n||(n=_JGE(r,document,!1,!0)));break;case this.XML_CHAMP_TYPE_VOLETONGLET:n&&(l=n.getElementsByTagName("a"),l.length&&(n=l[0]));break;case this.XML_CHAMP_TYPE_SOUSMENU:case this.XML_CHAMP_TYPE_OPTIONMENU:case this.XML_CHAMP_TYPE_MENUPOPUP:break;default:n=document.getElementById("lz"+r)}n&&(n.innerHTML=clWDUtil.sEncodeInnerHTML(f,!u,u))},ActionProprieteNote:function(n,t,i,r){!this.__bActionProprieteV2(t,r,39,this.sXMLGetValeur(i),undefined)},ActionProprieteTitreNote:function(n,t,i,r){!this.__bActionProprieteV2(t,r,40,this.sXMLGetValeur(i),undefined)},ActionProprieteHauteur:function(n,t,i,r,u){this.__ActionProprieteLargeurHauteur(n,t,i,r,u,"height",WDChamp.prototype.XML_CHAMP_PROP_NUM_HAUTEUR)},ActionProprieteLargeur:function(n,t,i,r,u){this.__ActionProprieteLargeurHauteur(n,t,i,r,u,"width",WDChamp.prototype.XML_CHAMP_PROP_NUM_LARGEUR)},__ActionProprieteLargeurHauteur:function(n,t,i,r,u,f,e){var s,o,h;if(n&&(s=this.nXMLGetValeur(r),s>=0)){o=s+"px";switch(i){case this.XML_CHAMP_TYPE_TIROIR:break;case this.XML_CHAMP_TYPE_JAUGE:clWDUtil.oAppelFonctionChamp(u,WDChamp.prototype.ms_sSetProp,[e,null,s,null,null]);n=_JGE(u,document,!0);n.getElementsByTagName("td")[0][f]=s;this.ActionProprieteStyleGenerique(n,t,i,u,f,o,!1);break;case WDChamp.prototype.ms_nIDObjetCellule:case this.XML_CHAMP_TYPE_SUPERCHAMP:case this.XML_CHAMP_TYPE_MODELEDECHAMP_DEST:for(h=n.getElementsByTagName("td")[0],""!=h.style[f]?h.style[f]=o:h[f]=s,this.ActionProprieteStyleGenerique(n,t,i,u,f,o,!1),n=n.parentNode;n&&n!=document.body;)switch(clWDUtil.sGetTagName(n)){case"table":n[f]=s;default:n=n.parentNode;break;case"div":this.ActionProprieteStyleGenerique(n,t,i,u,f,o,!1);n=null}break;case WDChamp.prototype.ms_nIDObjetInterrupteur:case this.XML_CHAMP_TYPE_SELECTEUR:this.ActionProprieteStyleGenerique(t,null,i,u,f,o,!1);break;case this.XML_CHAMP_TYPE_ONGLET:this.ActionProprieteStyleGenerique(t,null,i,u,f,o,!1);this.ActionProprieteStyleGenerique(document.getElementById("con-"+u),null,i,f,o,!1);break;case WDChamp.prototype.ms_nIDObjetLibelle:this.ActionProprieteStyleGenerique(n!=t&&document.getElementById("bz"+u)||n,null,i,u,f,o,!1);break;case this.XML_CHAMP_TYPE_GRAPHE:this.ActionProprieteStyleGenerique(document.getElementById(u)||n,null,i,u,f,o,!1);break;default:this.ActionProprieteStyleGenerique(n,t,i,u,f,s+"px",!1)}}},ActionProprieteX:function(n,t,i,r){this.ActionProprieteStyleGenerique(n,null,t,r,clWDUtil.bRTL?"right":"left",this.sXMLGetValeur(i)+"px",!1)},ActionProprieteY:function(n,t,i,r){this.ActionProprieteStyleGenerique(n,null,t,r,"top",this.sXMLGetValeur(i)+"px",!1)},ActionProprieteCouleur:function(n,t,i,r,u){var f=this.sXMLGetValeur(r),e=!1;switch(i){case WDChamp.prototype.ms_nIDObjetInterrupteur:case this.XML_CHAMP_TYPE_SELECTEUR:e=!0;break;case this.XML_CHAMP_TYPE_CHEMINNAV:case this.XML_CHAMP_TYPE_PLANSITE:case this.XML_CHAMP_TYPE_REGLETTE:case this.XML_CHAMP_TYPE_TREEVIEW:e=!0;break;case this.XML_CHAMP_TYPE_COLONNETABLE:case this.XML_CHAMP_TYPE_COLONNETABLEH:case this.XML_CHAMP_TYPE_JAUGE:this.ActionProprieteStylePolice(n,null,i,u,"color",f,!1);return;case WDChamp.prototype.ms_nIDObjetSaisie:clWDUtil.oAppelFonctionChamp(u,WDChamp.prototype.ms_sSetProp,[WDChamp.prototype.XML_CHAMP_PROP_NUM_COULEUR,null,f,n,null]);break;case this.XML_CHAMP_TYPE_LIEN:n=_JGE(u,document,!1,!1)}this.ActionProprieteStyleGenerique(n,t,i,u,"color",f,e)},ActionProprieteCouleurFond:function(n,t,i,r,u){var f=this.sXMLGetValeur(r),o=!1,e;switch(i){case WDChamp.prototype.ms_nIDObjetInterrupteur:case this.XML_CHAMP_TYPE_SELECTEUR:o=!0;break;case this.XML_CHAMP_TYPE_IFRAME_DEST:case this.XML_CHAMP_TYPE_IFRAME_SOURCE:case WDChamp.prototype.ms_nIDObjetCellule:case this.XML_CHAMP_TYPE_SUPERCHAMP:case this.XML_CHAMP_TYPE_MODELEDECHAMP_SOURCE:case this.XML_CHAMP_TYPE_MODELEDECHAMP_DEST:case this.XML_CHAMP_TYPE_CELLULEMISEENPAGE:case this.XML_CHAMP_TYPE_CELLULE_FLEXBOX:n=_JGE(u,document,!1);break;case this.XML_CHAMP_TYPE_TIROIR:n=_JGE(u,document,!0);break;case this.XML_CHAMP_TYPE_LIEN:e=_JGE(u,document,!0);e&&e.style&&(e.style.backgroundColor=f);break;case this.XML_CHAMP_TYPE_REGLETTE:o=!0;break;case WDChamp.prototype.ms_nIDObjetSaisie:clWDUtil.oAppelFonctionChamp(u,WDChamp.prototype.ms_sSetProp,[WDChamp.prototype.XML_CHAMP_PROP_NUM_COULEURFOND,null,f,n,null]);break;case this.XML_CHAMP_TYPE_JAUGE:case this.XML_CHAMP_TYPE_GRAPHE:clWDUtil.oAppelFonctionChamp(u,WDChamp.prototype.ms_sSetProp,[WDChamp.prototype.XML_CHAMP_PROP_NUM_COULEURFOND,null,f,n,null]);return;case this.XML_CHAMP_TYPE_TABLEAUDEBORD:n=_JGE(u,document,!1,!0)}this.ActionProprieteStyleGenerique(n,t,i,u,"backgroundColor",f,o)},ActionProprieteEtat:function(n,t,i,r,u){function o(n){return clWDUtil.ActiveDesactiveClassName(n,"wbgrise",4==f),!0}var f=this.nXMLGetAttribut(r,this.XML_CHAMP_ETAT_ETAT),e;switch(i){case WDChamp.prototype.ms_nIDObjetSaisie:case this.XML_CHAMP_TYPE_GRAPHE:clWDUtil.oAppelFonctionChamp(u,WDChamp.prototype.ms_sSetProp,[WDChamp.prototype.XML_CHAMP_PROP_NUM_ETAT,null,f,n,r]);break;case WDChamp.prototype.ms_nIDObjetBouton:case this.XML_CHAMP_TYPE_LIEN:case this.XML_CHAMP_TYPE_MAPAREA:case this.XML_CHAMP_TYPE_SOUSMENU:case this.XML_CHAMP_TYPE_OPTIONMENU:case this.XML_CHAMP_TYPE_MENUPOPUP:if(e=null,clWDUtil.bBaliseEstTag(n,"a"))e=n;else if(clWDUtil.bBaliseEstTag(n.parentNode,"a"))e=n.parentNode;else break;this._AppliqueAttributEtat(r,e,f,!1)}clWDUtil.bForEach(clWDUtil.tabGetElementsByClass(t,"wbstyle"),o);clWDUtil.bAvecClasse(t,"wbstyle")&&o(t);this.__bActionProprieteV2(i,u,26,f,undefined)},_AppliqueAttributEtat:function(n,t,i,r){var o,s,f,c,h;if(n){if(o=n.firstChild,o)for(s=o.attributes,c=s.length,f=0;f<c;f++){var l=s.item(f),u=l.name,a=u.toLowerCase(),e=l.value;if(i!=0)switch(a){case"onmouseout":case"onmouseover":case"onclick":t[u]=null;break;default:t.removeAttribute(u,0)}else switch(a){case"onmouseout":case"onmouseover":t[u]=new Function("","document."+e);break;case"onclick":if(r){h="";bFF&&-1!=(e+"").indexOf("event")&&(h="event");t[u]=new Function(h,e);break}default:t.setAttribute(u,e)}}}else i!=0?(t.setAttribute("disabled","disabled"),t.sOldOnClick=t.onclick,t.onclick=null,t.removeAttribute("onclick")):(t.removeAttribute("disabled"),t.sOldOnClick&&(t.onclick=t.sOldOnClick,t.removeAttribute("sOldOnClick")))},ActionProprieteVisible:function(n,t,i,r,u){var c=this.bXMLGetAttributSafe(r,this.XML_CHAMP_PROP_NUM_VISIBLE_PARENTRELATIF)||this.bXMLGetAttributSafe(r,this.XML_CHAMP_PROP_NUM_VISIBLE_PARENTFLUX),o=!1,s=!1,e=this.bXMLGetValeur(r),f=this.__oChercheChamp(t,u,i,!0,!0,c),h,l;switch(i){case this.XML_CHAMP_TYPE_COLONNETABLE:case this.XML_CHAMP_TYPE_COLONNETABLEH:f=document.getElementById("tt"+u);o=!0;break;case this.XML_CHAMP_TYPE_VOLETONGLET:f=n;f.parentElement.classList.contains("wbTabControlTabSep")&&(f=f.parentElement);e!=("none"!=f.style.display)&&(h=f.closest(".wbTabControl"),h.querySelector(".wbTabControlTabs").classList.contains("wbTabControlTabsSameSize")&&(l=+h.style.getPropertyValue("--wb-number_visible_tab"),h.style.setProperty("--wb-number_visible_tab",l+(e?1:-1))));case this.XML_CHAMP_TYPE_SOUSMENU:case this.XML_CHAMP_TYPE_OPTIONMENU:case this.XML_CHAMP_TYPE_MENUPOPUP:o=!0;s=!0;f?e&&"hidden"==f.style.visibility&&(f.style.visibility=""):clWDUtil.bForEach(["H","B"],function(n){return clWDUtil.SetDisplay(document.getElementById(n+"-"+u),e),!0});break;case this.XML_CHAMP_TYPE_DISPOSITION_CELLULE:o=!0;s=!0;f&&(clWDUtil.bBaliseEstTag(f,"li")||(f=f.parentElement));break;default:o=c;s=c}o?clWDUtil.SetDisplay(f,e,s):f&&f.style&&(f.style.visibility=e?"inherit":"hidden");f&&AppelMethode(WDChamp.prototype.ms_sOnDisplay,[f,e])},ActionProprieteGroupe:function(n,t,i){if(window.NSPCS)try{NSPCS.NSChamps.DeclareGroupes(NSPCS.NSUtil.xoEvalJSON(this.sXMLGetValeur(i),!1))}catch(r){}},ActionProprieteImage:function(n,t,i,r){if(n){var u=this.sXMLGetValeur(i);switch(t){case this.XML_CHAMP_TYPE_PAGECORNEE:n.style.backgroundImage=clWDUtil.sGetURICSS(u);clWDUtil.oAppelFonctionChamp(r,WDCornage.prototype.ms_sInitTailleImage,[u]);break;default:n.src=u}}},ActionProprieteURL:function(n,t,i,r){var e=n,u,f;switch(t){case this.XML_CHAMP_TYPE_MAPAREA:n&&clWDUtil.bBaliseEstTag(n,"img")&&clWDUtil.bBaliseEstTag(n.parentNode,"a")&&(n=n.parentNode);break;default:n=_JGE(r,document,!1,!0);n||(n=e)}n&&clWDUtil.bBaliseEstTag(n,"td")&&(n=n.children[0]);u=this.sXMLGetValeur(i);n&&(clWDUtil.bBaliseEstTag(n,"input")?a(n,r,nt,function(){return"('"+u+"'"}):n.href=u);f="_UC_"+r+"_"+WDChamp.prototype.XML_CHAMP_PROP_NUM_URL+"_";undefined!=window[f]&&(window[f]=u)},ActionProprieteBulle:function(n,t,i,r){function f(n){return n.title=u,!0}var u=this.sXMLGetValeur(i);switch(t){case WDChamp.prototype.ms_nIDObjetInterrupteur:case this.XML_CHAMP_TYPE_SELECTEUR:clWDUtil.bForEach(document.getElementsByName(r),f);return;case this.XML_CHAMP_TYPE_TABLE:case this.XML_CHAMP_TYPE_TABLEHIERARCHIQUE:n=this.__oGetConteneurParent(r,t,!1);break;case this.XML_CHAMP_TYPE_VOLETONGLET:n&&clWDUtil.bForEach(n.getElementsByTagName("a"),f);break;case this.XML_CHAMP_TYPE_JAUGE:clWDUtil.oAppelFonctionChamp(r,WDChamp.prototype.ms_sSetProp,[WDChamp.prototype.XML_CHAMP_PROP_NUM_BULLE,null,u,null,null]);return;case WDChamp.prototype.ms_nIDObjetBouton:n.children[0]&&(n.children[0].title=u)}n&&(n.title=u)},ActionProprieteCurseurSouris:function(n,t,i,r){this.ActionProprieteStyleGenerique(n,null,t,r,"cursor",this.sXMLGetValeur(i),!0)},ActionProprietePoliceGras:function(n,t,i,r,u){this.ActionProprieteStylePolice(n,t,i,u,"fontWeight",this.nXMLGetValeur(r),!0)},ActionProprietePoliceItalique:function(n,t,i,r,u){this.ActionProprieteStylePolice(n,t,i,u,"fontStyle",this.bXMLGetValeur(r)?"italic":"normal",!0)},ActionProprietePoliceNom:function(n,t,i,r,u){this.ActionProprieteStylePolice(n,t,i,u,"fontFamily",this.sXMLGetValeur(r),!0)},ActionProprietePoliceSoulignee:function(n,t,i,r,u){this.ActionProprieteStylePolice(n,t,i,u,"textDecoration",this.bXMLGetValeur(r)?"underline":"none",!0)},ActionProprietePoliceTaille:function(n,t,i,r,u){this.ActionProprieteStylePolice(n,t,i,u,"fontSize",this.sXMLGetValeur(r),!0)},ActionProprieteOpacite:function(n,t,i,r,u){var f=this.nXMLGetValeur(r);isNaN(f)?f=100:f<0?f=0:f>100&&(f=100);switch(i){case this.XML_CHAMP_TYPE_GRAPHE:case this.XML_CHAMP_TYPE_JAUGE:clWDUtil.oAppelFonctionChamp(u,WDChamp.prototype.ms_sSetProp,[WDChamp.prototype.XML_CHAMP_PROP_NUM_OPACITE,null,f,n,null]);return;case this.XML_CHAMP_TYPE_PAGECORNEE:break;default:n=t}clWDUtil.nSetOpacite(f,n)},ActionProprieteCadrageH:function(n,t,i,r,u){this.ActionProprieteStylePolice(n,t,i,u,"textAlign",this.sXMLGetValeur(r),!0)},ActionProprieteCadrageV:function(n,t,i,r,u){this.ActionProprieteStylePolice(n,t,i,u,"verticalAlign",this.sXMLGetValeur(r),!0)},ActionProprieteSelectionnee:function(n,t,i,r){var u=this.bXMLGetValeur(r),e,o,f;switch(i){case this.XML_CHAMP_TYPE_SOUSMENU:case this.XML_CHAMP_TYPE_OPTIONMENU:case this.XML_CHAMP_TYPE_MENUPOPUP:e=u?"":"Select";o=u?"Select":"";clWDUtil.bForEach(["WDOngletOption","WDMenuOption"],function(n){return clWDUtil.bForEach(["","Hover"],function(i){return clWDUtil.RemplaceClassNameSiExiste(t,n+e+i,n+o+i),!0}),!0});f=t.getElementsByTagName("a")[0];f&&clWDUtil.ActiveDesactiveClassName(f,"wbActif",u)}},ActionProprieteIndication:function(n,t,i,r){clWDUtil.oAppelFonctionChamp(r,WDChamp.prototype.ms_sSetProp,[WDChamp.prototype.XML_CHAMP_PROP_NUM_INDICATION,null,this.sXMLGetValeur(i),n,null])},ActionProprieteBoutonCalendrier:function(n,t,i,r){clWDUtil.oAppelFonctionChamp(r,WDChamp.prototype.ms_sSetProp,[WDChamp.prototype.XML_CHAMP_PROP_NUM_BOUTONCALENDRIER,null,this.bXMLGetValeur(i),n,null])},ActionProprieteContenu:function(n,t,i,r,u,f){var e,o,s;switch(r){case WDChamp.prototype.ms_nIDObjetImage:case this.XML_CHAMP_TYPE_MAPAREA:case this.XML_CHAMP_TYPE_VIGNETTE:case this.XML_CHAMP_TYPE_GRAPHE:case this.XML_CHAMP_TYPE_RANGESLIDER:case this.XML_CHAMP_TYPE_AGENDA:case this.XML_CHAMP_TYPE_VIDEO:case this.XML_CHAMP_TYPE_PLANNING:case this.XML_CHAMP_TYPE_JAUGE:case this.XML_CHAMP_TYPE_CARTE:case this.XML_CHAMP_TYPE_POTENTIOMETRE:case this.XML_CHAMP_TYPE_TCD:case this.XML_CHAMP_TYPE_BANDEAU_DEFILANT:case this.XML_CHAMP_TYPE_CHAMPKANBAN:case this.XML_CHAMP_TYPE_EDITEURCODEWL:clWDUtil.oAppelFonctionChampPtr(f,WDChamp.prototype.DeduitParam,[this.sXMLGetValeur(u)]);break;case this.XML_CHAMP_TYPE_IFRAME_DEST:try{e=JSON.parse(this.sXMLGetValeur(u));e.id=f;clWDUtil.DemontePageInterne(this.__oGetElementPI(e),f,e,undefined,!0);clWDUtil.MontePageInterne(this.__oGetElementPI(e),f,e,!1)}catch(h){}break;case this.XML_CHAMP_TYPE_EDITEUR_DIAGRAMME:o=clWDUtil.oEvalJSON(this.sXMLGetValeur(u));s=t[f+"_DATA"];s.wbSetParametreDonnees(o[0],o[1]);break;default:clWDUtil.oAppelFonctionChampPtr(f,WDChamp.prototype.PreAffecteHTML,[!0]);i.innerHTML=this.sXMLGetValeur(u);clWDUtil.oAppelFonctionChampPtr(f,WDChamp.prototype.PostAffecteHTML,[!0])}},ActionProprieteValeurSuperieure:function(n,t,i,r){clWDUtil.oAppelFonctionChamp(r,WDChamp.prototype.ms_sSetProp,[WDChamp.prototype.XML_CHAMP_PROP_NUM_VALEURSUPERIEURE,null,this.sXMLGetValeur(i),n,null])},ActionProprieteClasseHTML:function(n,t,i,r){(!n||n instanceof HTMLCollection||window.RadioNodeList&&n instanceof RadioNodeList||window.NodeList&&n instanceof NodeList)&&(n=t);n.className=clWDUtil.sSetClasseHTML_SERVEUR(this.sXMLGetValeur(r),n)},ActionProprieteTexteAlternatif:function(n,t,i){var r=this.sXMLGetValeur(i);switch(t){case WDChamp.prototype.ms_nIDObjetImage:case this.XML_CHAMP_TYPE_MAPAREA:case this.XML_CHAMP_TYPE_VIGNETTE:case this.XML_CHAMP_TYPE_GRAPHE:case this.XML_CHAMP_TYPE_CAPTCHA:case WDChamp.prototype.ms_nIDObjetCodeBarre:n&&(n.alt=r)}},ActionProprietePlan:function(n,t,i,r){var u,e,f;this.bXMLAttributExiste(i,"PLAN")?(u=this.nXMLGetAttribut(i,"PLAN"),e=this.sXMLGetValeur(i),f=this.sXMLGetAttribut(i,"FILS")):u=this.nXMLGetValeur(i);this.__bActionProprieteV2(t,r,31,u,{sContenuHTML:e})||(this.XML_CHAMP_TYPE_PAGEPRINCIPALE==t&&(r="MaPage"),$(".wbPlanDe"+r).wbPlanSet(u,{sContenuHTML:e}));f&&f.length&&clWDUtil.DeclareChampPlanDiffere(f.split(";"))},ActionProprieteCodeHTML:function(n,t,i){for(var r=n.parentNode;!!(oNextSibling=n.nextSibling);)r.removeChild(oNextSibling);n.insertAdjacentHTML("afterend",this.sXMLGetValeur(i))},ActionProprieteImageFond:function(n,t,i,r){!this.__bActionProprieteV2(t,r,34,this.sXMLGetValeur(i),undefined)},ActionProprieteCouleurJauge:function(n,t,i,r){var u=this.sXMLGetValeur(i);switch(t){case this.XML_CHAMP_TYPE_JAUGE:clWDUtil.oAppelFonctionChamp(r,WDChamp.prototype.ms_sSetProp,[WDChamp.prototype.XML_CHAMP_PROP_NUM_COULEURJAUGE,null,u,n,null]);return}},ActionProprieteBulleTitre:function(n,t,i,r){!this.__bActionProprieteV2(t,r,56,this.sXMLGetValeur(i),undefined)},ActionProprieteMenuContextuel:function(n,t,i,r){WDMenu.s_UpdateMenuContextuel(r,this.sXMLGetValeur(i))},ms_DataWBAttributHTML:"data-wb-attributhtml",ms_sDataWBAttributHTMLSeparateur:":",ActionProprieteAttributHTML:function(n){if(n){var t=n.getAttribute(this.ms_DataWBAttributHTML),i=t?t.split(this.ms_sDataWBAttributHTMLSeparateur):[],r=[];for(let t=oXMLAction.firstChild;t;t=t.nextSibling)"ATT"===t.nodeName&&clWDUtil.bForEach(t.attributes,function(t){var u=t.name;return n.setAttribute(u,t.value),clWDUtil.SupprimeDansTableau(i,u),r.push(u),!0});i.forEach(function(t){return n.removeAttribute(t)});n.setAttribute(this.ms_DataWBAttributHTML,r.join(this.ms_sDataWBAttributHTMLSeparateur))}},ActionProprieteExtra:function(n,t,i,r){if(window.NSPCS){var u;try{u=JSON.parse(this.sXMLGetValeur(i))}catch(f){u=null}NSPCS.NSChamps.ms_oSynchronisationServeur.SetProprieteServeur(r,158,u)}},ActionProprieteStylePolice:function(n,t,i,r,u,f,e){var o=t;switch(i){case WDChamp.prototype.ms_nIDObjetSaisie:case WDChamp.prototype.ms_nIDObjetBouton:case this.XML_CHAMP_TYPE_LISTE:case this.XML_CHAMP_TYPE_CHAMPFORMATE:case WDChamp.prototype.ms_nIDObjetCombo:case this.XML_CHAMP_TYPE_LIEN:case this.XML_CHAMP_TYPE_TREEVIEW:case WDChamp.prototype.ms_nIDObjetLibelle:o=n;break;case this.XML_CHAMP_TYPE_COLONNETABLE:case this.XML_CHAMP_TYPE_COLONNETABLEH:this.ActionProprieteCouleurFeuilleStyle("#c-"+r,u,f);return;case this.XML_CHAMP_TYPE_JAUGE:o=oGetObjetChamp(r).m_oLibelleInterne}this.ActionProprieteStyleGenerique(o,t,i,r,u,f,e)},ActionProprieteStyleGenerique:function(n,t,i,r,u,f,e){if(n){if(e)switch(i){case WDChamp.prototype.ms_nIDObjetInterrupteur:case this.XML_CHAMP_TYPE_SELECTEUR:(n instanceof HTMLCollection||window.RadioNodeList&&n instanceof RadioNodeList||window.NodeList&&n instanceof NodeList)&&clWDUtil.bForEach(n,function(n){var t=n.parentNode;return t&&clWDUtil.bBaliseEstTag(t,"label")&&(n=t),n.style[u]=f,!0});n=_JGE(r.substr(r.length-2,2)=="[]"?r.substr(0,r.length-2):r,document,!1,!0);break;case this.XML_CHAMP_TYPE_CHEMINNAV:case this.XML_CHAMP_TYPE_PLANSITE:case this.XML_CHAMP_TYPE_REGLETTE:case this.XML_CHAMP_TYPE_TREEVIEW:clWDUtil.bForEach(n.getElementsByTagName("a"),function(n){return n.style[u]=f,!0})}n.style&&(n.style[u]=f)}},ActionProprieteCouleurFeuilleStyle:function(n,t,i){for(var u=document.getElementsByTagName("style"),f=u.length,r=0;r<f;r++)clWDUtil.tabStyleTrouveDansBalise(u[r],n,!1).forEach(function(n){n.style[t]=i})},__bActionProprieteV2:function(n,t,i,r,u){if(window.NSPCS){var f;return f=1==n?NSPCS.NSChamps.oGetPageCourante():NSPCS.NSChamps.oGetChamp(t,n),f&&f.viGetPropriete(1,i).vSetValeur(r,0,{m_oParametresSpecifiques:u}),!0}return!1},ActionChampJS:function(n,t,i,r){var f=this.sXMLGetValeur(i),u;n||(n=_JGE(r,document));switch(t){case this.XML_CHAMP_TYPE_VOLETONGLET:n&&-1===f.indexOf("getElementsByTagName")&&(u=n.getElementsByTagName("a"),u.length&&(n=u[0]))}n&&function(){eval("arguments[0]"+f)}(n)},ActionChampOptions:function(n,t,i,r){var u,e,f,o,s;if(n)for(u=i.firstChild,e=1;u;){f=r+"_"+e;switch(u.nodeName){default:case this.XML_CHAMP_OPTIONS_OPTION:switch(t){case WDChamp.prototype.ms_nIDObjetInterrupteur:o=document.getElementById(f);switch(this.nXMLGetAttributSafe(u,this.XML_CHAMP_OPTIONS_OPTION_COCHE,0)){case 1:o.checked=!0;break;case 2:o.checked=!1}this.__OptionParLabelFor(u,f,1);break;case this.XML_CHAMP_TYPE_SELECTEUR:this.__OptionParLabelFor(u,f,1);break;case WDChamp.prototype.ms_nIDObjetInterrupteurABascule:this.__OptionParLabelFor(u,f,2);break;default:s=new Option(this.sXMLGetValeur(u),n.options.length+1);this.bXMLAttributExiste(u,"VALMEM")&&s.setAttribute("data-wb-valmem",this.sXMLGetAttribut(u,"VALMEM"));n.options[n.options.length]=s}e++;break;case this.XML_CHAMP_SATURATION:n.options[n.options.length]=new Option(this.sXMLGetValeur(u),-1)}u=u.nextSibling}},__OptionParLabelFor:function(n,t,i){var u,r,f,e,o;if(document.querySelector&&(u=document.querySelector("label[for='"+t+"']"),u)){for(r=u,f=0;f<i&&r;f++)e=r.getElementsByTagName("span"),r=e&&e[0];r&&(o=this.bXMLGetAttributSafe(n,this.XML_CHAMP_OPTIONS_OPTION_HTML),r.innerHTML=clWDUtil.sEncodeInnerHTML(this.sXMLGetValeur(n),!o,o))}},ActionChampLignes:function(n,t,i,r,u){var f=oGetObjetChamp(r);f&&f.bActionListeDepuisAJAX?f.bActionListeDepuisAJAX(i,-1):n&&this.ActionChampLignesInterne(n,t,i,r,u)},ActionChampLignesInterne:function(n,t,i,r,u){var d=this.nXMLGetAttribut(i,this.XML_CHAMP_LIGNES_DEBUT),g=this.nXMLGetAttribut(i,this.XML_CHAMP_LIGNES_NOMBRE),ht=this.nXMLGetAttribut(i,this.XML_CHAMP_LIGNES_SELECTION),v=this.nXMLGetAttributSafe(i,this.XML_CHAMP_LIGNES_RUPTURES,0),ut=this.nXMLGetAttributSafe(i,this.XML_CHAMP_LIGNES_COLONNES,1),ct=1<ut,lt=u[r+"_DATA"],nt,ft,at,y,b,p,et,s,dt,gt,ot,st,tt,it,rt;lt&&(lt.value=this.sXMLGetAttributSafe(i,this.XML_CHAMP_LIGNES_DATA,""));for(var w=parseInt(u[r+"_DEB"].value,10),c,l=this.__oGetConteneurParent(r,t,!0),e=this.__oGetConteneurTBODY(l,t);w<d&&this.__bSupprimeLigne(r,t,w,v,l,e);)w++;if(w>=d+g)while(this.__bSupprimeLigne(r,t,w,v,l,e))w++;if(0<v)switch(t){case this.XML_CHAMP_TYPE_TABLE:case this.XML_CHAMP_TYPE_ZONEREPETEE:for(nt=i.firstChild;nt;)c=this.nXMLGetAttribut(nt,this.XML_CHAMP_LIGNES_LIGNE_INDICE),this.__SupprimeRuptures(r,c,v,e),nt=nt.nextSibling}if(1==this.nXMLGetAttributSafe(i,this.XML_CHAMP_REFRESH_RESETTABLE,0)){for(at="tt"+r,y=document.getElementById(at),y&&!clWDUtil.bEstFils(y,e)&&(y=null),b=e.childNodes,clWDUtil.bForEachInverse(b,function(n){return n.nodeName=="#text"&&e.removeChild(n),!0}),p=0;p<b.length;)ft=b[p],y?(ft==y&&(p+1<b.length&&b[p+1].offsetHeight<=1&&p++,y=null),p++):e.removeChild(ft);et="rgs-"+r+"-";clWDUtil.bForEachInverse(document.getElementsByTagName("style"),function(n){var t=n.id;return t&&et==t.substr(0,et.length)&&n.parentNode.removeChild(n),!0})}for(var vt=[],k=-1,ni=this.bXMLAttributExiste(i,this.XML_CHAMP_LIGNES_STYLE),a=i.firstChild;a;a=a.nextSibling){c=this.nXMLGetAttribut(a,this.XML_CHAMP_LIGNES_LIGNE_INDICE);var f=this.__oGetConteneurLigne(r,c,e),yt="",h="",pt="",wt="";Array.prototype.forEach.call(a.childNodes,function(n){var i=clWDUtil.sSupprimeEspacesDebutFin(clWDAJAXMain.sXMLGetValeur(n)),t;switch(n.nodeName){case"DEBUT":yt=i;break;case"CORPS":h=i;break;case"FIN":pt=i;break;case"STYLE":wt=i;break;case"PI":try{t=JSON.parse(i);undefined!==t.alias_original?(t.id="zrl_"+c+"_"+t.alias_original,t.alias_monte_demonte=t.alias_original):(t.id=r+"_"+c,t.alias_monte_demonte=r);vt.push(t)}catch(u){}}});var bt=this.bXMLGetAttributSafe(a,this.XML_CHAMP_LIGNES_LIGNE_INVISIBLE),kt=this.bXMLGetAttributSafe(a,this.XML_CHAMP_LIGNES_LIGNE_REPLIEE),o=yt+h+pt;if(ni&&this.ActionLigneStyle(r,c,wt),!bt&&!f){for(s=null,dt=d+g,k=Math.max(k-1,c+1);k<dt&&!s;k++)s=this.__oTrouveRuptureExterne(r,!0,k,v,e),s||(s=this.__oGetConteneurLigne(r,k,e));if(s){0<o.length&&(this.__bHTMLDebutTR(o)?(clWDUtil.bBaliseEstTag(s,"td")&&(s=s.parentNode),kt||o.substr(o.length-5,5).toLowerCase()=="<\/tr>"?this.__InsereElementDansTable(s,o):this.__InsereRemplaceTrTdDansTable(s,o,!0,null)):o.substr(o.length-5,5).toLowerCase()=="<\/tr>"?(clWDUtil.bBaliseEstTag(s,"td")&&(s=s.parentNode),this.__InsereRemplaceTrTdDansTable(s,o,!1,null)):this.__AjouteElementDansTable(s.parentElement.previousElementSibling,o));continue}}f?(f=document.getElementById(r+"_"+c),t==this.XML_CHAMP_TYPE_ZONEREPETEE&&this.__SupprimeRuptures(r,c,v,e),bt?(clWDUtil.bBaliseEstTag(f,"div")&&clWDUtil.bBaliseEstTag(f.parentElement,"td")&&this.__bAvecFilsActifUnique(f.parentElement)&&(f=f.parentElement,clWDUtil.bBaliseEstTag(f.parentElement,"tr")&&this.__bAvecFilsActifUnique(f.parentElement)&&(f=f.parentElement)),clWDUtil.oSupprimeElement(f)):(clWDUtil.bBaliseEstTag(f,"div")&&clWDUtil.bBaliseEstTag(f.parentElement,"td")&&(f=f.parentElement),this.__bHTMLDebutTR(h)?(gt=f,clWDUtil.bBaliseEstTag(f,"td")&&(f=f.parentElement),kt?(this.__InsereElementDansTable(f,h),f=this.__bAvecFilsActifUnique(f)?f:gt,clWDUtil.oSupprimeElement(f)):h.substr(h.length-5,5).toLowerCase()!="<\/tr>"?this.__InsereRemplaceTrTdDansTable(f,h,!0,f.children[0]):this.__RemplaceElementDansTable(f,h)):h.substr(h.length-5,5).toLowerCase()=="<\/tr>"?(clWDUtil.bBaliseEstTag(f,"td")?(ot=f.parentElement,st=f):(ot=f,st=f.lastElementChild),this.__InsereRemplaceTrTdDansTable(ot,h,!1,st)):this.__RemplaceElementDansTable(f,h)),l==e&&(l=this.__oGetConteneurParent(r,t,!0),e=this.__oGetConteneurTBODY(l,t))):o.length>0&&(tt=e,this.__bHTMLDebutTR(o)?o.substr(o.length-5,5).toLowerCase()!="<\/tr>"&&(o=o+"<\/tr>"):h.substr(h.length-5,5).toLowerCase()=="<\/tr>"?ct?(tt=e.lastElementChild,o=o.substr(0,h.length-5)):o="<tr>"+o:ct&&this.__bHTMLDebutTD(o)&&(tt=e.lastElementChild),this.__AjouteElementDansTable(tt,o),l===e&&(l=this.__oGetConteneurParent(r,t,!0),e=this.__oGetConteneurTBODY(l,t)))}for(clWDUtil.bBaliseEstTag(e,"tbody")&&clWDUtil.bForEachInverse(e.childNodes,function(n){return 0===n.childNodes.length&&e.removeChild(n),!0}),c=d+g,it=ut;;)if(this.__bSupprimeLigne(r,t,c,v,l,e))c++,it=ut;else if(it>1)c++,it--;else break;g===0&&e!==l&&e.childNodes.length===0&&clWDUtil.SupprimeFils(l);u[r+"_DEB"].value=d;rt=u["_"+r+"_OCC"];rt===undefined&&(rt=u[r+"_OCC"]);rt.value=g;ht>=0&&(n.value=ht);vt.forEach(function(n){clWDUtil.DemontePageInterne(clWDAJAXMain.__oGetElementPI(n),n.alias_monte_demonte,n,undefined,!0);clWDUtil.MontePageInterne(clWDAJAXMain.__oGetElementPI(n),n.alias_monte_demonte,n,!1)});switch(t){case this.XML_CHAMP_TYPE_TABLE:case this.XML_CHAMP_TYPE_TABLEHIERARCHIQUE:case this.XML_CHAMP_TYPE_ZONEREPETEE:case this.XML_CHAMP_TYPE_ZONEREPETEEHORIZONTALE:AppelMethodePtr(WDChamp.prototype.OnTableZRAfficheAJAX,[r])}clWDUtil.m_oNotificationsAjoutHTML.LanceNotifications(this,l)},__oGetElementPI:function(n){var t=document.getElementById(n.id);return clWDUtil.bBaliseEstTag(t,"table")?t.firstElementChild.firstElementChild.firstElementChild:t},ActionLigneStyle:function(n,t,i){var f,u,r,e;if("<style "===i.substr(0,7))this.__SupprimeStyleLigne(n,t),f=document.getElementsByTagName("head")[0],f.insertAdjacentHTML("beforeend",i);else for(u=i.split("}"),e=u.length,r=0;r<e;r++)this._ActionLigneStyleLigne(u[r])},_ActionLigneStyleLigne:function(n){var u=n.indexOf("{"),e,i,t,f;if(!(u<=0)){e=n.substring(0,u);i=n.substring(u+1);i=this.__sTrim(i,!0,!0);for(var s=clWDUtil.oGetFeuilleStyle(document.getElementsByTagName("style")[0]),o=e.split(","),h=o.length,r=0;r<h;r++)(t=this.__sTrim(o[r]),t=t.replace(v,""),t.length!==0&&t!=="#")&&(f=this._oActionSupprimeStyle(t.toLowerCase()),i.length>0&&clWDUtil.CreeStyle(f?f:s,t,i))}},_oActionSupprimeStyle:function(n){for(var s=document.getElementsByTagName("style"),l=s.length,o,t,i,h,c,u=0;u<l;u++)for(var f=clWDUtil.oGetFeuilleStyle(s[u]),e=clWDUtil.tabGetStyleReglesAvecImportConst(f),a=e.length,r=0;r<a;r++)if(o=e[r].selectorText,o)for(t=o.split(","),h=t.length,i=0;i<h;i++)if(t[i]=clWDUtil.sSupprimeEspaces(t[i]),t[i].toLowerCase()===n){t.splice(i,1);c=e[r].style.cssText;clWDUtil.StyleSupprime(f,r);0<t.length&&clWDUtil.CreeStyle(f,t.join(","),c);return}},ActionChampTreeview:function(n,t,i){var r,u;document.getElementsByName(i+"_AS")[0].value=this.sXMLGetValeur(t.childNodes[0]);document.getElementsByName(i)[0].value=this.sXMLGetValeur(t.childNodes[1]);r=this.sXMLGetValeur(t.childNodes[2]);document.getElementsByName("NEX_"+i)[0].value=r;window["oItems_"+i]=r.split(",");u=document.getElementById(i+"_");u.innerHTML=this.sXMLGetValeur(t.childNodes[3])},ActionChampRecharge:function(n,t,i,r){var e,f,u,o,s;if(n){if(this.bXMLAttributExiste(i,this.XML_CHAMP_RECHARGE_PARAM)){switch(t){case this.XML_CHAMP_TYPE_GRAPHE:e=WDGraphe.prototype.DeduitParamBarre;break;default:e=WDChamp.prototype.DeduitParam}clWDUtil.oAppelFonctionChampPtr(r,e,[this.sXMLGetAttribut(i,this.XML_CHAMP_RECHARGE_PARAM)])}f=new RegExp("("+r+"\\=)(\\d+)","i");u=n.src;f.test(u)?n.src=u.replace(f,function(n,t,i){return t+(parseInt(i,10)+1)}):(o=new RegExp("("+r+"\\=)([^\\d]|$)","i"),o.test(u)&&(n.src=u.replace(o,function(n,t,i){return t+(new Date).getTime()+i})));s=n.parentNode;clWDUtil.bBaliseEstTag(s,"a")&&a(s,r,f,function(n,t,i){return t+(parseInt(i,10)+1)})}},ActionChampRefresh:function(n,t,i){var e=this.nXMLGetAttributSafe(t,this.XML_CHAMP_REFRESH_RESETTABLE,0),r=this.sXMLGetAttributSafe(t,this.XML_CHAMP_REFRESH_DEBUT,""),u=-1,f;r===""||isNaN(parseInt(r,10))||(u=parseInt(r,10),r.indexOf(";")>-1&&(f=r.substring(r.indexOf(";")+1)));var o=this.nXMLGetAttributSafe(t,this.XML_CHAMP_REFRESH_NOMBRE,undefined),s=this.sXMLGetAttributSafe(t,this.XML_CHAMP_REFRESH_DATA,undefined),h=this.nXMLGetAttributSafe(t,this.XML_CHAMP_REFRESH_TRI,-1),c=this.bXMLGetAttributSafe(t,this.XML_CHAMP_REFRESH_SENS,!1);i&&i.m_oChampTable.m_sAliasChamp===n&&i.SupprimeRequete(!1);clWDUtil.oAppelFonctionChampPtr(n,WDChamp.prototype.Refresh,[e,u,f,s,o,t.firstChild,h,c])},ActionChampSaisieAssistee:function(n,t){var f,r,i,e,u;if(window.$&&(f=$("."+n),r=f.add(f.find("input")).last(),this.bXMLAttributExiste(t,this.XML_CHAMP_SAISIEA_FILTRE)&&r.data("saisieassistee-filtre",this.nXMLGetAttribut(t,this.XML_CHAMP_SAISIEA_FILTRE)),this.bXMLAttributExiste(t,this.XML_CHAMP_SAISIEA_OUVERTUREAUTO)&&r.data("saisieassistee-ouvertureauto",this.bXMLGetAttributSafe(t,this.XML_CHAMP_SAISIEA_OUVERTUREAUTO)),this.bXMLAttributExiste(t,this.XML_CHAMP_SAISIEA_TAILLEMIN)&&r.data("saisieassistee-taillemin",this.nXMLGetAttribut(t,this.XML_CHAMP_SAISIEA_TAILLEMIN)),this.bXMLAttributExiste(t,this.XML_CHAMP_SAISIEA_DELAI)&&r.data("saisieassistee-delai",this.nXMLGetAttribut(t,this.XML_CHAMP_SAISIEA_DELAI)),this.bXMLAttributExiste(t,this.XML_CHAMP_SAISIEA_SANSCASSE)&&r.data("saisieassistee-sanscasse",this.nXMLGetAttribut(t,this.XML_CHAMP_SAISIEA_SANSCASSE)),i=t.firstChild,i)){for(r.autocomplete("wbRazAutocompleteProg"),e=[];i;){switch(i.nodeName){case this.XML_CHAMP_SAISIEA_OPTION:u=this.sXMLGetValeur(i);this.bXMLAttributExiste(i,"VALMEM")&&(u=[u,this.sXMLGetAttribut(i,"VALMEM")]);e.push(u)}i=i.nextSibling}r.autocomplete("wbConcatAutocompleteProg",e)}},ActionChampSaisieAJeton:function(n,t){var i=document.getElementsByName(n)[0],r=document.getElementsByName(n+"_DATA")[0];i&&r&&(r.value=this.sXMLGetValeur(t),i.wbJetonChargeDepuisChampCache())},ActionChampSaisieMasque:function(n,t){var i=document.getElementsByName(n)[0];i&&i.wbSaisieMasqueSetJSON&&i.wbSaisieMasqueSetJSON(this.sXMLGetValeur(t))},ActionChamp:function(n,t,i){for(var u=this.sXMLGetAttribut(t,this.XML_CHAMP_ATT_ALIAS),f=this.nXMLGetAttribut(t,this.XML_CHAMP_ATT_TYPE),e=this.__oChercheChamp(n,u,f),o=this.__oChercheChamp(n,u,f,!0,!1),r=t.firstChild;r;){switch(r.nodeName){case this.XML_CHAMP_PROP:switch(this.nXMLGetAttribut(r,this.XML_CHAMP_PROP_ATT_NUM)){case WDChamp.prototype.XML_CHAMP_PROP_NUM_VALEURAFFICHEE:case WDChamp.prototype.XML_CHAMP_PROP_NUM_VALEUR:this.ActionProprieteValeur(e,o,f,r,u);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_LIBELLE:this.ActionProprieteLibelle(e,f,r,u,!1);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_NOTE:this.ActionProprieteNote(e,f,r,u);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_LIBELLEHTML:this.ActionProprieteLibelle(e,f,r,u,!0);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_HAUTEUR:this.ActionProprieteHauteur(e,o,f,r,u);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_LARGEUR:this.ActionProprieteLargeur(e,o,f,r,u);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_COULEUR:this.ActionProprieteCouleur(e,o,f,r,u);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_COULEURFOND:this.ActionProprieteCouleurFond(e,o,f,r,u);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_ETAT:this.ActionProprieteEtat(e,o,f,r,u);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_VISIBLE:this.ActionProprieteVisible(e,n,f,r,u);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_TITRENOTE:this.ActionProprieteTitreNote(e,f,r,u);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_GROUPE:this.ActionProprieteGroupe(e,f,r,u);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_IMAGE:this.ActionProprieteImage(e,f,r,u);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_URL:this.ActionProprieteURL(e,f,r,u);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_BULLE:this.ActionProprieteBulle(e,f,r,u);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_X:o=this.__oChercheChamp(n,u,f,!0,!0);this.ActionProprieteX(o,f,r,u);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_Y:o=this.__oChercheChamp(n,u,f,!0,!0);this.ActionProprieteY(o,f,r,u);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_CURSEURSOURIS:this.ActionProprieteCurseurSouris(o,f,r);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_POLICEGRAS:this.ActionProprietePoliceGras(e,o,f,r,u);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_POLICEITALIQUE:this.ActionProprietePoliceItalique(e,o,f,r,u);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_POLICENOM:this.ActionProprietePoliceNom(e,o,f,r,u);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_POLICESOULIGNE:this.ActionProprietePoliceSoulignee(e,o,f,r,u);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_POLICETAILLE:this.ActionProprietePoliceTaille(e,o,f,r,u);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_OPACITE:this.ActionProprieteOpacite(e,o,f,r,u);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_CADRAGEH:this.ActionProprieteCadrageH(e,o,f,r,u);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_CADRAGEV:this.ActionProprieteCadrageV(e,o,f,r,u);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_SELECTIONNEE:this.ActionProprieteSelectionnee(e,o,f,r,u);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_INDICATION:this.ActionProprieteIndication(e,f,r,u);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_BOUTONCALENDRIER:this.ActionProprieteBoutonCalendrier(e,f,r,u);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_CONTENU:this.ActionProprieteContenu(e,n,o,f,r,u);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_VALEURSUPERIEURE:this.ActionProprieteValeurSuperieure(e,f,r,u);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_CLASSEHTML:this.ActionProprieteClasseHTML(e,o,f,r,u);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_TEXTEALTERNATIF:this.ActionProprieteTexteAlternatif(e,f,r);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_PLAN:this.ActionProprietePlan(e,f,r,u);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_CODEHTML:this.ActionProprieteCodeHTML(e,f,r,u);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_IMAGEFOND:this.ActionProprieteImageFond(e,f,r,u);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_COULEURJAUGE:this.ActionProprieteCouleurJauge(e,f,r,u);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_BULLETITRE:this.ActionProprieteBulleTitre(e,f,r,u);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_MENUCONTEXTUEL:this.ActionProprieteMenuContextuel(e,f,r,u);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_ATTRIBUTHTML:this.ActionProprieteAttributHTML(e,f,r,u);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_EXTRA:this.ActionProprieteExtra(e,f,r,u)}break;case this.XML_CHAMP_JS:this.ActionChampJS(e,f,r,u);break;case this.XML_CHAMP_LIGNES:this.ActionChampLignes(e,f,r,u,n);e=this.__oChercheChamp(n,u,f);o=this.__oChercheChamp(n,u,f,!0);break;case this.XML_CHAMP_OPTIONS:this.ActionChampOptions(e,f,r,u);break;case this.XML_CHAMP_RECHARGE:this.ActionChampRecharge(e,f,r,u);break;case this.XML_CHAMP_REFRESH:this.ActionChampRefresh(u,r,i);break;case this.XML_CHAMP_SAISIEA:this.ActionChampSaisieAssistee(u,r);break;case this.XML_CHAMP_SAISIEAJETON:this.ActionChampSaisieAJeton(u,r);break;case this.XML_CHAMP_SAISIEMASQUE:this.ActionChampSaisieMasque(u,r);break;case this.XML_CHAMP_TREEVIEW:this.ActionChampTreeview(e,r,u)}r=r.nextSibling}},ActionJS:function(n,t){eval(this.sXMLGetValeur(t))},bActionRedirection:function(n,t){var i=decodeURI(this.sXMLGetValeur(t));return document.location.assign(i),"tel:"!==i.substring(0,4)&&"email:"!==i.substring(0,4)},ActionTrace:function(n,t,i){function s(n){n&&f.push(clWDUtil.sGetInnerText(n))}for(var r=_JGE(this.XML_TRACE_ID,document),u=this.sXMLGetValeur(t),f=[],e,o;e=_JGE(this.XML_WBTRACE_ID,document);)i&&s(e),clWDUtil.oSupprimeElement(e);if(i&&(s(r),0<u.length&&f.push(u),u=f.join("\r\n")),0===u.length){clWDUtil.oSupprimeElement(r);return}r||(r=document.createElement("div"),r.id=this.XML_TRACE_ID,r.style.width="1024px",r.style.backgroundColor="#ffd264",r.style.color="#000000",r.style.fontFamily="Courier New,Courier,mono",r.style.fontSize="small",r.style.textAlign="left",o=document.body.children[0],r=o?document.body.insertBefore(r,o):document.body.insertBefore(r));r.innerHTML=clWDUtil.sEncodeInnerHTML(u,!0)},ActionMAJLienSociaux:function(n){this.__ActionMAJLienSocial(n,this.XML_LIENSOCIAL_FACEBOOK,["FB","XFBML"],"parse");this.__ActionMAJLienSocial(n,this.XML_LIENSOCIAL_TWEETER,["twttr","widgets"],"load");this.__ActionMAJLienSocial(n,this.XML_LIENSOCIAL_LINKEDIN,["IN"],"init")},__ActionMAJLienSocial:function(n,t,i,r){if(t===(n&t)){for(var u=window,e=i.length,f=0;f<e;f++)if(u=u[i[f]],!u)return;u[r]&&u[r]()}},__ActionVarSync:function(n){var u=this.sXMLGetAttributSafe(n,"parentnom",""),f=this.nXMLGetAttributSafe(n,"parenttype",0),i=this.sXMLGetAttributSafe(n,"nom",""),r=this.sXMLGetValeur(n),t;i&&r&&(t=NSPCS.NSValues.xiGetVariable(i,u,f),t&&NSPCS.NSOperations.Deserialise(t,r,1024))},__ActionGaleriesIDs:function(n){var t=this.sXMLGetValeur(n);t&&clWDUtil.oGetImageInformations(clWDUtil.oEvalJSON(t,{}))},__eActionXML:function(n,t,i,r){for(var s=1,u=i.firstChild,h=!1,e,o,f;u;){switch(u.nodeName){case this.XML_CHAMP:this.ActionChamp(n,u,t);break;case this.XML_JS:this.ActionJS(n,u);break;case this.XML_REDIR:s=this.bActionRedirection(n,u)?2:0;break;case this.XML_LISTE:t.ActionListe(u);h=!0;break;case this.XML_RESULTAT:f=this.sXMLGetValeur(u);switch(this.sXMLGetAttributSafe(u,this.XML_RESULTAT_FORMAT,"")){case"JSON":try{f=NSPCS.NSValues.oAny2Natif(NSPCS.NSUtil.xoMarshallingFenetrePageSimple(f))}catch(c){f=""}}r.push(f);break;case this.XML_TRACE:e=u;break;case this.XML_LIENSOCIAL:o=this.nXMLGetValeur(u);break;case this.XML_VARSYNC:this.__ActionVarSync(u);break;case this.XML_GALERIESIDS:this.__ActionGaleriesIDs(u)}u=u.nextSibling}return e&&this.ActionTrace(n,e,h),o&&this.ActionMAJLienSociaux(o),s},eActionXML:function(n,t,i,r){var e=i.getElementsByTagName(this.XML_RACINE),u,s,f,o;return e&&(u=e?e[0]:null,u)?(s=this.__eActionXML(n,t,u,r),f=u.childNodes,f&&(o=f.length,(2<=o||1===o&&f[0].nodeName!==this.XML_LISTE)&&clWDUtil.m_oNotificationsFinAJAX.LanceNotifications()),s):0},ErreurAJAX:function(){var n=clWDUtil.sGetPageAction(null,!0);n+="?"+this.sCommandeAjax_Erreur;document.location=n},AJAXExecuteEvenement:function(n,t,i,r,u,e){if(f){f=!1;return}if(this.bWDAJAXMainValide()){if(!this.AJAXDisponible()){this.NormalExecuteEvenement(n,t,i,r,u);return}switch(r){case 17:this.bAJAXExecuteEvenementInterne(n,t,i,r,u,e,!1);this.s_ReactualiseActivite(!0);return}var o={};o.oPage=n;o.sChamp=t;o.nEvenement=i;o.nOption=r;o.m_nTraitementApresAjax=u;o.m_oValeurSelonOption=e;this.m_tabRequetes.push(o);this.s_ReactualiseActivite(!0);window.WDAnimSurPopup&&WDAnimSurPopup.prototype.s_Pause();this.__SetTimeoutTraiteAJAXExecuteEvenement()}},__SetTimeoutTraiteAJAXExecuteEvenement:function(){this.m_bForceAppelSynchrone?(this.TraiteAJAXExecuteEvenement(),delete this.m_bForceAppelSynchrone):undefined===this.m_nSetTimeout_AJAX&&(this.m_nSetTimeout_AJAX=clWDUtil.nSetTimeout(w,clWDUtil.ms_oTimeoutImmediat))},TraiteAJAXExecuteEvenement:function(){for(delete this.m_nSetTimeout_AJAX,this.s_ReactualiseActivite(!1);this.m_tabRequetes.length>0;){var n=this.m_tabRequetes.shift(),t=this.bAJAXExecuteEvenementInterne(n.oPage,n.sChamp,n.nEvenement,n.nOption,n.m_nTraitementApresAjax,n.m_oValeurSelonOption,!0);if(t||(this.m_tabRequetes.length=0),this.m_bInvokeAndWait&&this.m_tabRequetes.length>0){this.__SetTimeoutTraiteAJAXExecuteEvenement();break}}},bAJAXExecuteEvenementInterne:function(n,t,i,r,u,f,e){function h(){var i;switch(l.eReponseGenerique(o,n,null,[])){case 0:i=!1;break;case 1:i=!0;break;case 2:i=!0;u=null}switch(typeof u){case"function":u();break;case"number":clWDUtil.pfGetTraitement(t,u)()}return i}var l=this,s,c,o;if(this.bWDAJAXMainValide())try{if(s=this.sConstuitRequeteEvenement(n,t,i,r,f),""===s)return!0;if(c=this.sConstruitURL(clWDUtil.sGetPageAction(n)),o=this.clCreeWDAJAXRequete(!0,e),o){if(e||(o.m_fCallback=h),this.__xEnvoi(o,s,c),e)return h()}else return this.ErreurAJAX(),!1}finally{window.WDAnimSurPopup&&WDAnimSurPopup.prototype.s_Continue()}},__xEnvoi:function(n,t,i){var r=n.m_bSynchrone;try{r&&u++;this.s_ReactualiseActivite(!1);n.xEnvoi(t,i)}finally{r&&(u--,this.s_ReactualiseActivite(!1))}},NormalExecuteEvenement:function(n,t,i,r){switch(r){case 1:case 2:_JSL(n,t,"_self","","");break;case 3:break;case 4:window["_R"+t](i);break;default:_JCL(n.action+"?"+t,"_self","","")}},sRequeteSynchroneTexte:function(n,t,i,r){var u=this.clCreeWDAJAXRequete(n,!0),f;return u?(this.__xEnvoi(u,t,i),f=u.bValideResultat()?u.sGetResultat(r):"",u.Libere(),u=null,f):(this.ErreurAJAX(),"")},sRequeteAsynchroneTexte:function(n,t,i,r,u){var f=this.clCreeWDAJAXRequete(n,!1),e;return f?(e=f.m_nId,!r&&u&this.ms_nAJAXExecuteChamps&&(r=clWDUtil.m_pfVide),f.m_bJSONExterne=!!(u&this.ms_nAJAXExecuteJSONExterne),f.m_fCallback=r,this.__xEnvoi(f,t,i),e):(this.ErreurAJAX(),"")},JSONExecute:function(n){var t=this.sRequeteSynchroneTexte(!1,"",n,window._PAGE_);return clWDUtil.oEvalJSON(t,{})},AJAXExecuteSynchrone:function(n,t){return this.__AJAXExecute(n,!1,null,t,this.ms_nAJAXExecuteDefaut,2,arguments)},AJAXExecuteSynchrone20:function(n,t,i){return this.__AJAXExecute(n,!1,null,t,i,3,arguments)},AJAXExecuteAsynchrone:function(n,t,i){return this.__AJAXExecute(n,!0,t,i,this.ms_nAJAXExecuteDefaut,3,arguments)},AJAXExecuteAsynchrone20:function(n,t,i,r){return this.__AJAXExecute(n,!0,t,i,r,4,arguments)},__sGetCommandeAJAX:function(n){var t=this.sCommandeAjax_ExecuteProc;return 0!=(n&this.ms_nAJAXExecuteChamps)&&(t+=this.sCommandeAjax_ExecuteProcSChamps),0!=(n&this.ms_nAJAXExecuteNonExclusif)&&(t+=this.sCommandeAjax_ExecuteProcSNonExclusif),0!=(n&this.ms_nAJAXExecutePOSTChamps)&&(t+=this.sCommandeAjax_ExecuteProcSPOSTChamps),t},__AJAXExecute:function(n,t,i,r,u,f,e){var o,s,h,c;return this.bWDAJAXMainValide()?(o=this.sCommandeAjax_Execute,o+="&"+this.__sGetCommandeAJAX(u)+"="+encodeURIComponent(n),o+="&"+this.sCommandeAjax_Contexte+"="+encodeURIComponent(r),0!=(u&this.ms_nAJAXExecuteSynchroniseVariables)&&window.NSPCS&&(s=NSPCS.NSChamps.ms_oSynchronisationServeur.sGetReporteVariableServeur(),s&&(o+="&"+this.sCommandeAjax_SynchroniseVariables+"="+encodeURIComponent(s))),o+=clWDUtil.sConstuitProcedureParams(f,e,0!=(u&this.ms_nAJAXTypesStructures)),0!=(u&this.ms_nAJAXExecutePOSTChamps)&&(h=this.sConstruitValeurPage(window._PAGE_.elements),h&&(o+="&"+h)),c=this.sConstruitURL(clWDUtil.sGetPageAction()),t?this.sRequeteAsynchroneTexte(!0,o,c,i,u):this.sRequeteSynchroneTexte(!0,o,c,window._PAGE_)):""},AJAXAppelAsynchroneEnCours:function(n){if(!this.bWDAJAXMainValide())return!1;var t=this.GetWDAJAXRequete(n);return t?t.bEnCours():!1},AJAXAnnuleAppelAsynchrone:function(n){if(!this.bWDAJAXMainValide())return!1;var t=this.GetWDAJAXRequete(n);t&&t.Annule()},__nAJAXRecupereLignesTable:function(n,t){var r,i,u;return this.bWDAJAXMainValide()?(r=this.sConstruitURL(clWDUtil.sGetPageAction()),i=this.clCreeWDAJAXRequete(!0,!1,n),i?(u=i.m_nId,this.__xEnvoi(i,t,r),u):(this.ErreurAJAX(),!1)):!1},nAJAXRecupereLignesTable:function(n,t){var i=this.sConstuitRequeteTable(t);return this.__nAJAXRecupereLignesTable(n,i)},nAJAXRecupereLignesTableSelection:function(n,t,i){var r=this.sConstuitRequeteEvenement(window._PAGE_,n.m_oChampTable.m_sAliasChamp,0,i?5:6,undefined)+"&"+t;return this.__nAJAXRecupereLignesTable(n,r)},nAJAXRecupereLignesTableEnrouleDeroule:function(n,t,i){this.SetZRChampEnrouleDeroule(window._PAGE_,n.m_oChampTable.m_sAliasChamp,t,-1);var r=this.sConstuitRequeteEvenement(window._PAGE_,n.m_oChampTable.m_sAliasChamp,"ENDETABLE",10,undefined);return i.length>0&&(r+=i),this.__nAJAXRecupereLignesTable(n,r)},oAJAXRecupereJauge:function(n){var t={m_eJauge:0},i,r;return this.bWDAJAXMainValide()&&(i=this.sConstuitURLRequeteJauge(n),r=this.sRequeteSynchroneTexte(!1,"",i,window._PAGE_),t=clWDUtil.oEvalJSON(r,t)),t},InitActivite:function(n,i){t=_JGE(n,document,!0);c=i;clWDUtil.AttacheOnScrollResize(e);e()},s_ReactualiseActivite:function(t){var i=0<n.length||0<u||t;r!==i&&(r=i,e())}}}();clWDUtil.m_oNotificationsFinAJAX.AddNotification(function(){window.$&&$(window).trigger("trigger.wb.disposition.visible.maj")})