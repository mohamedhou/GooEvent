/*! 29.0.1.0 */
/*! VersionVI: 01A302032    */
var WDSaisieRiche=function(){"use strict";function t(n,t){return n.compareBoundaryPoints(0,t)==0&&n.compareBoundaryPoints(2,t)==0}function u(n,t){var f=clWDUtil.tabHTML2RVBA(n),u=clWDUtil.sRVB2HTML(f).substr(1).toLowerCase(),r=t.querySelector(".wbColorPickerChoice"+u);r||(r=t.querySelector(".wbColorPickerChoice"+u.toUpperCase()));r&&i(r,t)}function i(n,t){var i=t.querySelector(".wbColorPickerChoiceChecked");i&&i.classList.remove("wbColorPickerChoiceChecked");n.classList.add("wbColorPickerChoiceChecked")}function n(n,t,i,r,u){arguments.length&&(WDBarre.prototype.constructor.apply(this,arguments),this.m_tabBoutonsInfo&&this.m_tabBoutonsInfo.UND!==undefined&&(this.m_tabBoutonsInfo.RED=this.m_tabBoutonsInfo.UND),this.m_bBaliseP=u[6],this.m_bModeEmail=!!u[7],this.m_bModeSansStyleWB=this.m_bModeEmail?!1:!!u[8],this.m_fKeyDown=function(n){return this.bOnKeyDown(n)}.bind(this),this.m_fRafBarreTrueMasqueAutre=function(n){return this.__RafBarreMasqueAutre(n||event)}.bind(this),this.m_fRafBarreSans=function(n){return this.RafBarre(n||event)}.bind(this))}function r(n,t,i,r){for(var o=t.length,f,e,u=0;u<o;u++)(f=t[u],e=n[f],r&&"0"==e.charAt(0))||(i[f]=e)}var f=function(){function n(n,t,i,r){arguments.length&&WDBarreBouton.prototype.constructor.apply(this,[n,t,i,r])}return n.prototype=new WDBarreBouton,n.prototype.constructor=n,n}(),e=function(){function n(n,t,i,r,u){arguments.length&&(WDBarreBoutonOnOff.prototype.constructor.apply(this,[n,t,"ExecuteCommande",[i,!1,null]]),this.m_sStyle=r,this.m_tabStyleValeur=u)}return n.prototype=new WDBarreBoutonOnOff,n.prototype.constructor=n,n.prototype.__DessineEtat=function(n,t,i){WDBarreBouton.prototype.__DessineEtat.apply(this,arguments);n==this.ms_eEtatActif?(i.classList.add("wbActif"),i.firstElementChild.classList.add("wbActif"),i.firstElementChild.firstElementChild.classList.add("wbActif")):(i.classList.remove("wbActif"),i.firstElementChild.classList.remove("wbActif"),i.firstElementChild.firstElementChild.classList.remove("wbActif"))},n.prototype.ExecuteCommande=function(n){var t=this.m_oObjetParent.oGetParamEtat(n,!1);if(t[0]&&this.m_sStyle!="textAlign"){if(this.m_oRange&&(delete this.m_oRange,delete this.m_bForceActif),this.m_sStyle)switch(this._veGetEtatSpecifique(n,this.ms_eEtatNormal,t)){case this.ms_eEtatNormal:this.m_bForceActif=!0;break;case this.ms_eEtatActif:this.m_bForceActif=!1}this.m_oRange=t[0]}WDBarreBoutonOnOff.prototype.ExecuteCommande.apply(this,arguments)},n.prototype.bActif=function(n,i){if(this.m_oRange){try{if(t(this.m_oRange,i[0]))return this.m_bForceActif}catch(r){}delete this.m_oRange;delete this.m_bForceActif}if(this.m_sStyle&&i[2]&&this.m_sStyle.length)switch(this.m_oParamCommande[0]){case"italic":if(this.__bStyleMatchRecursif(i[1],"em"))return!0;break;case"underline":if(this.__bStyleMatchRecursif(i[1],"u"))return!0;break;case"strikeThrough":if(this.__bStyleMatchRecursif(i[1],"strike"))return!0;break;case"bold":if(i[2][this.m_sStyle]=="normal")return!1;default:if(this.__bStyleMatch(i[2][this.m_sStyle]))return!0}return!1},n.prototype.__bStyleMatchRecursif=function(n,t){while(n&&n!=this.m_oObjetParent.m_oData&&n.nodeType!==Node.DOCUMENT_NODE){if(this.__bStyleMatch(clWDUtil.oGetCurrentStyle(n)[this.m_sStyle])||n.tagName&&clWDUtil.bBaliseEstTag(n,t))return!0;n=n.parentNode}return!1},n.prototype.__bStyleMatch=function(n){return this.m_tabStyleValeur.some(function(t){return t?t.bTst?n.indexOf(t.sVal)!=-1:n!=t.sVal:!1})},n}(),o=function(){function n(n,t,i,r,u,f){var o,e,s;arguments.length&&(WDBarreBoutonPopup.prototype.constructor.apply(this,[n,t,"ExecuteCommande",[i,!1,null],r]),this.m_sStyle=f,o=this,document.body.addEventListener("click",this.m_oBouton.onmouseout),document.body.addEventListener("keydown",function(n){n.keyCode==27&&(o.m_oBouton.onmouseout.apply(this,arguments),o.m_oObjetParent.SetFocus())}),window.addEventListener("blur",this.m_oBouton.onmouseout),e=HTML_TOOLBAR[u],e&&(e=[HTML_TOOLBAR.COSP[0]].concat(Object.keys(e).map(function(n){return e[n]})),Array.prototype.forEach.call(r.getElementsByTagName("span"),function(n,t){clWDUtil.SupprimeFils(n);e[t]!==undefined&&n.appendChild(document.createTextNode(e[t]))})),this.m_oParamCommande&&this.m_oParamCommande.length&&this.m_oParamCommande[0]==="wbInsertTable"&&!r.querySelector("input")&&(s=$(r).find("tr").first(),s.parent().append($('<tr><td style="padding:6px;"><label><input type="checkbox" checked/> '+HTML_TOOLBAR.DLG.TSY+"<\/label><\/td><\/tr>"))))}function t(n){return clWDUtil.sRVB2HTML(clWDUtil.tabHTML2RVBA(n))}return n.prototype=new WDBarreBoutonPopup,n.prototype.constructor=n,n.prototype.OnMouseLeave=function(n){var t,i;this.m_oParamCommande&&this.m_oParamCommande.length&&this.m_oParamCommande[0]==="wbInsertTable"&&(t=clWDUtil.oGetTarget(n),t&&t.firstElementChild&&t.firstElementChild.tagName.toLocaleLowerCase()!=="div"&&(i=$(t).find("div"),i.css("background","")))},n.prototype.OnMouseEnter=function(n){var t,i,r;if(this.m_oParamCommande&&this.m_oParamCommande.length&&this.m_oParamCommande[0]==="wbInsertTable"&&(t=clWDUtil.oGetTarget(n),t&&t.firstElementChild&&t.firstElementChild.tagName.toLocaleLowerCase()==="div")){var u=$(t),e=u.closest("td").index(),o=u.closest("tr").index(),f=u.closest("table"),s=f.find("div");for(s.css("background",""),i=0;i<=o;++i)for(r=0;r<=e;++r)f.find("tr").eq(i).find("div").eq(r).css("background","goldenrod")}},n.prototype.OnClickP=function(n){var r=clWDUtil.oGetTarget(n),u=clWDUtil.oGetOriginalTarget2(n),e;if(this.m_oParamCommande&&this.m_oParamCommande.length&&this.m_oParamCommande[0]==="wbInsertTable"){if(u&&u.firstElementChild&&u.firstElementChild.tagName.toLocaleLowerCase()==="div"){var f=$(r),o=f.closest("td").index(),s=f.closest("tr").index();this.m_oParamCommande[2]=[o+1,s+1];e=f.closest(".WDBarreOutilsPopup").find("input").get(0).checked;this.m_oParamCommande[3]=e;WDBarreBouton.prototype.ExecuteCommande.apply(this,[n])}}else this.m_oParamCommande&&this.m_oParamCommande.length&&this.m_oParamCommande[0].indexOf("Color")>0&&clWDUtil.bBaliseEstTag(r,"div")&&(this.m_oParamCommande[2]=this.m_sStyle=="backgroundColor"?clWDUtil.sRVBA2HTML(clWDUtil.tabHTML2RVBA(clWDUtil.oGetCurrentStyle(r).backgroundColor)):t(clWDUtil.oGetCurrentStyle(r).backgroundColor),WDBarreBouton.prototype.ExecuteCommande.apply(this,[n]),i(r,this.m_oBouton));WDBarreBoutonPopup.prototype.OnClickP.apply(this,arguments)},n.prototype.OnMouseOut=function(n){var t=n.type!="mouseout"?clWDUtil.oGetTarget(n):n.relatedTarget;t!=window&&clWDUtil.bEstFils(t,this.m_oBouton)||(n.type!="mouseout"&&this.__SetDisplayPopup(!1),WDBarreBouton.prototype.OnMouseOut.apply(this,arguments))},n.prototype._veGetEtatSpecifique=function(n,t,i){return this.m_sStyle&&i[2]&&i[2][this.m_sStyle]&&u(i[2][this.m_sStyle],this.m_oBouton),t},n.prototype.__DessineEtat=function(n,t,i,r){n!=t.m_eEtat&&(n!=this.ms_eEtatNormal?t.m_eEtat=n:delete t.m_eEtat,i.style.backgroundColor=this.m_oObjetParent.sGetCouleurFond(n),r[2]&&(i.style.color=r[2][this.m_sStyle]))},n}(),s=function(){function r(n){switch(+n){case 1:return 10;case 2:return 13;case 3:return 16;case 4:return 18;case 5:return 24;case 6:return 32;case 7:return 48;default:return+n}}function n(n,t,i,r,u,f,e){var h,o,a,s,c,l;if(arguments.length){for(this.m_domInputCombo=t.previousElementSibling.previousElementSibling,this.m_domLabelReplie=t.previousElementSibling,this.m_sSuffixe=f,this.m_oObjetParent=n,this.m_oCombo=t,this.m_sCommande=i,this.m_sStyle=r,this.m_oCombo.options&&this.m_oCombo.options.length&&(this.m_oCombo.options.length=0),h=HTML_TOOLBAR[f],a=u.length,o=0;o<a;o++)if(s=u[o],clWDUtil.isArray(s))c=o,h&&h[o]&&(c=h[o]),this.ajouteOption(c,s);else if(s){if(s.bMasquerEnRelookUL)continue;c=s.sN;h&&h[o]&&(c=h[o]);this.ajouteOption(c,s.sV||s)}this.vPostPlaceBarre();!bTouchMobile&&e&&(l=this.m_domLabelReplie.getAttribute("for").replace("CHECKBOX","INPUT"),this.m_domInputCombo.parentElement.lastElementChild.id===l||(this.m_domInputSaisie=document.createElement("input"),this.m_domInputSaisie.type="text",this.m_domInputSaisie.id=l,this.m_domInputCombo.parentElement.append(this.m_domInputSaisie),this.m_domInputCombo.addEventListener("keydown",function(n){n.stopPropagation();n.code==="Escape"?(n.preventDefault(),this.m_domInputCombo.blur()):(n.preventDefault(),this.m_domInputSaisie.focus(),this.m_domInputSaisie.value=n.key.length===1?n.key:"")}.bind(this)),this.m_domInputSaisie.addEventListener("focus",function(){this.m_domInputSaisie.select()}.bind(this)),this.m_domInputSaisie.addEventListener("change",function(n){this.m_domInputSaisie.value.length&&this.OnChange(n,this.m_domInputSaisie.value)}.bind(this)),this.m_domInputSaisie.addEventListener("keydown",function(n){n.stopPropagation();n.code==="Escape"?(n.preventDefault(),this.m_domInputSaisie.value="",this.m_domInputSaisie.blur(),this.m_oObjetParent.m_oDocument.body.focus()):(n.code==="Enter"||n.code==="NumpadEnter")&&(n.preventDefault(),this.OnChange(n,this.m_domInputSaisie.value),this.m_domInputSaisie.blur())}.bind(this))));n.m_tabDescBarre.some(function(n){return n&&n.sCom==i?(this.__Selection(n.nIndiceSelectionDefaut||0,n.sV),!0):!1}.bind(this))}}function i(n){for(var i=n.split(","),u=i.length,r,t=0;t<u;t++){for(r=i[t].length;r>0&&(i[t].charAt(0)=="'"||i[t].charAt(0)==" ");)i[t]=i[t].substring(1),r--;while(r>0&&(i[t].charAt(r-1)=="'"||i[t].charAt(r-1)==" "))i[t]=i[t].substring(0,r-1),r--}return i}return n.prototype.vPrePlaceBarre=function(){this.m_oCombo.onmousedown=null},n.prototype.vPostPlaceBarre=function(){this.m_oCombo.onmousedown=function(n){this.OnChange(n||event)}.bind(this)},n.prototype.OnChange=function(n,t){var i=clWDUtil.oGetTarget(n),f,r,u;(clWDUtil.bBaliseEstTag(i,"input")&&(i=this.m_domLabelReplie.nextElementSibling.firstElementChild),i.parentNode&&clWDUtil.bBaliseEstTag(i.parentNode,"label")&&(i=i.parentNode),clWDUtil.bBaliseEstTag(i,"label")&&(i=i.parentNode),clWDUtil.bBaliseEstTag(i,"li"))&&(f=this.m_oObjetParent.oGetRange(),f&&(this.m_oRange=f),this.m_oObjetParent.ExecuteCommande(n,[this.m_sCommande,!1,t!==undefined?t:this.getOptionValue(i)]),"FormatBlock"==this.m_sCommande&&(r=clWDUtil.oGetCurrentStyle(i.firstElementChild.firstElementChild),u=this.m_oObjetParent.oGetParamEtat(n,!1)[2],r.fontWeight!=u.fontWeight&&this.m_oObjetParent.ExecuteCommande(n,["bold",!1,r.fontWeight!="normal"&&r.fontWeight!="400"]),r.fontStyle!=u.fontStyle&&this.m_oObjetParent.ExecuteCommande(n,["italic",!1,r.fontStyle.indexOf("normal")==-1]),r.textDecoration!=u.textDecoration&&this.m_oObjetParent.ExecuteCommande(n,[r.textDecoration.indexOf("none")==-1,!1,null])),this.m_oObjetParent.RafBarre(n,!0))},n.prototype.RafEtatSimple=function(n){this.RafEtat(n,this.m_oObjetParent.oGetParamEtat(n,!1))},n.prototype.RafEtat=function(n,i){if(this.m_oRange){try{t(this.m_oRange,i[0])}catch(u){}delete this.m_oRange}if(i[2]){var r=i[2][this.m_sStyle];switch(this.m_sCommande){case"FontSize":this.__RafEtat_Taille(n,r);break;case"FontName":r&&r[0]=='"'&&r[r.length-1]=='"'&&(r=r.substr(1,r.length-2));r=r.replace(/"/g,"'");this.__RafEtat_Police(n,r);break;case"FormatBlock":this.__RafEtat_Format(n,i[1])}}},n.prototype.__RafEtat_Taille=function(n,t){var i,f,e;t=t.replace(/'/g,"");var o=t,u=function(n){return!this.m_oObjetParent.m_tabDescBarre.filter(function(n){return n.sSuf=="FSI"})[0].tabP.filter(function(t){return t.sN==n})[0].bMasquerEnRelookUL}.bind(this),r=function(n,t,i,r){return u(n)?t<i?!0:t<r&&(!u(n+1)||r-t>t-i)?!0:!1:!1};t.charAt(t.length-2)=="p"&&(i=parseFloat(t),t.charAt(t.length-1)=="t"&&(i*=96/72),r(1,i,11.5,14.5)?t="1":r(2,i,14.5,17)?t="2":r(3,i,17,21)?t="3":r(4,i,21,28)?t="4":r(5,i,28,40)?t="5":r(6,i,40,48)?t="6":u(7)&&(t="7"));f=this.__tabRechercheValeurCombo(t,function(n,t){return n.toUpperCase()==t.toUpperCase()});f.length>0&&(e=f[0]);this.__Selection(e,o)},n.prototype.__RafEtat_Police=function(n,t){var r=i(t),e=r.join(","),h=function(n,t){return n.toUpperCase()==i(t)[0].toUpperCase()},u,o=this.__tabRechercheValeurCombo(r[0],h),f,s;if(o.length>0){for(s=o.length,f=0;f<s;f++)if(e.toUpperCase().indexOf(i(this.getOptionValue(o[f])).join(",").toUpperCase())==0){u=o[f];break}u===undefined&&(u=this.ajouteOption(r.length?r[0]:r[0]+"("+e+")",e))}else u=this.ajouteOption(r[0],e);this.__Selection(u,r[0])},n.prototype.__RafEtat_Format=function(n,t){for(var u=0,f=this.m_oObjetParent.m_oData,i="",r;t&&t!=f;){if(i="<"+clWDUtil.sGetTagName(t)+">",r=this.__tabRechercheValeurCombo(i,function(n,t){return n==t}),0<r.length){u=r[0];break}i="";t=t.parentNode}this.__Selection(u,i.length?i:"")},n.prototype.__tabRechercheValeurCombo=function(n,t){for(var r=[],u=this.m_oCombo.childElementCount,i=0;i<u;i++)t(n,this.getOptionValue(i))&&r.push(i);return r},n.prototype.__Selection=function(n,t){var r=n,u,f,i,e;clWDUtil.isObject(n)||(r=this.m_oCombo.children[n]);r&&(u=r.firstElementChild,this.m_domLabelReplie.innerHTML=u.innerHTML,this.m_domLabelReplie.removeAttribute("title"),this.m_domLabelReplie.firstElementChild&&this.m_domLabelReplie.firstElementChild.removeAttribute("title"),f=this.m_oCombo.querySelector(".wbBarreOutilComboLabelActif"),f&&f.classList.remove("wbBarreOutilComboLabelActif"),u.classList.add("wbBarreOutilComboLabelActif"),!bEdge&&r.scrollIntoView&&(i=$(this.m_oObjetParent.m_oHote).closest(".dzSpanRiche,.dzSpan"),i.length||(i=$(window)),e=i.scrollTop(),r.scrollIntoView(),i.get(0).scrollTo(i.scrollLeft(),e)));this.m_domInputSaisie&&(t&&t.length&&this.m_domLabelReplie.firstElementChild&&(this.m_domLabelReplie.firstElementChild.innerText=t),document.activeElement!==this.m_domInputSaisie&&(this.m_domInputSaisie.value=t))},n.prototype.getOptionValue=function(n){var t=clWDUtil.isObject(n)?n:this.m_oCombo.children[n];return t.firstElementChild.firstElementChild.classList.contains("wbSaisirRicheOptionValueInnerHTML")?t.firstElementChild.firstElementChild.innerHTML:t.firstElementChild.firstElementChild.dataset.wbsaisiericheoptionvalue.replace(/&quot;/g,'"')},n.prototype.ajouteOption=function(n,t){var s,o,i,u,h,f,c,e;if(this.m_sCommande=="wbEmoji"&&clWDUtil.isObject(t)){if(this.m_oObjetParent.m_tabBoutonsInfo[this.m_sSuffixe]&&this.m_oObjetParent.m_tabBoutonsInfo[this.m_sSuffixe].bVisible===!1)return;this.m_oCombo.classList.contains("wbBarreOutilsComboListeDroite")||(this.m_oCombo.classList.add("wbBarreOutilsComboListeDroite"),this.m_domInputCombo.addEventListener("change",function(){this.m_oCombo.classList.add("wbBarreOutilsComboListeDroite");this.m_oCombo.getBoundingClientRect().x<0&&this.m_oCombo.classList.remove("wbBarreOutilsComboListeDroite")}.bind(this)));for(s in t)o=document.createElement("li"),o.setAttribute("class","wbBarreOutilsComboListeOption"),i=document.createElement("label"),i.setAttribute("for",this.m_domInputCombo.id),i.setAttribute("class","wbBarreOutilComboLabel"),u=document.createElement("span"),u.setAttribute("class","wbSaisirRicheOptionValueInnerHTML"),u.setAttribute("title",clWDUtil.sEncodeInnerHTML(t[s],!0)),u.appendChild(document.createTextNode(String.fromCodePoint(parseInt("0"+s.substr(2,6),16)))),i.appendChild(u),o.appendChild(i),this.m_oCombo.appendChild(o)}else{h=this.m_sCommande=="FormatBlock"?t.substr(4,t.length-8):"span";f='<li class="wbBarreOutilsComboListeOption"><label for="'+this.m_domInputCombo.id+'" class="wbBarreOutilComboLabel"><'+h;switch(this.m_sCommande){case"FontSize":typeof t=="string"&&(isNaN(+t)?t.indexOf("px")>-1?e=parseFloat(t):c=t:e=r(+t),e&&(c=clWDUtil.bRWD?e/16+"rem":e+"px"));f+=' style="font-family:Helvetica,Arial,sans-serif;font-size:'+c+';"';break;case"FontName":f+=" style=\"font-family:'"+t.split(",").join("','")+"';\"";break;case"FormatBlock":f+=' style="font-family:Helvetica,Arial,sans-serif;"'}this.m_oCombo.innerHTML+=f+' data-wbSaisieRicheOptionValue="'+t.replace(/"/g,"&quot;")+'">'+n+"<\/"+h+"><\/label><\/li>"}return this.m_oCombo.childElementCount-1},n}();n.prototype=new WDBarre;n.prototype.constructor=n;var h="_EDT",c=["borderTopWidth","borderTopStyle","borderTopColor","borderLeftWidth","borderLeftStyle","borderLeftColor","borderRightWidth","borderRightStyle","borderRightColor","borderBottomWidth","borderBottomStyle","borderBottomColor","borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius"],l=["paddingLeft","paddingTop","paddingRight","paddingBottom"],a=WDSaisieRiche_ms_tabEmojis;return n.prototype.m_tabDescBarre=[{nType:0,sSuf:"GRA",sCom:"bold",sSty:"fontWeight",tabP:[{sVal:"400",bTst:!1}]},{nType:0,sSuf:"ITA",sCom:"italic",sSty:"fontStyle",tabP:[{sVal:"italic",bTst:!0},{sVal:"oblique",bTst:!0}]},{nType:0,sSuf:"SOU",sCom:"underline",sSty:"textDecoration",tabP:[{sVal:"underline",bTst:!0}]},{nType:0,sSuf:"BAR",sCom:"strikeThrough",sSty:"textDecoration",tabP:[{sVal:"line-through",bTst:!0}]},{nType:0,sSuf:"AGA",sCom:"JustifyLeft",sSty:"textAlign",tabP:[{sVal:"left",bTst:!0}]},{nType:0,sSuf:"ACE",sCom:"JustifyCenter",sSty:"textAlign",tabP:[{sVal:"center",bTst:!0}]},{nType:0,sSuf:"ADR",sCom:"JustifyRight",sSty:"textAlign",tabP:[{sVal:"right",bTst:!0}]},{nType:0,sSuf:"AJU",sCom:"JustifyFull",sSty:"textAlign",tabP:[{sVal:"justify",bTst:!0}]},{nType:0,sSuf:"LNU",sCom:"InsertOrderedList",sSty:"",tabP:[]},{nType:0,sSuf:"LPU",sCom:"InsertUnorderedList",sSty:"",tabP:[]},{nType:0,sSuf:"RMO",sCom:"Outdent",sSty:"",tabP:[]},{nType:0,sSuf:"RPL",sCom:"Indent",sSty:"",tabP:[]},{nType:0,sSuf:"EXP",sCom:"superscript",sSty:"",tabP:[]},{nType:0,sSuf:"IND",sCom:"subscript",sSty:"",tabP:[]},{nType:0,sSuf:"UND",sCom:"undo",tabRaccourcis:[{ctrlKey:!0,key:"z"}]},{nType:0,sSuf:"RED",sCom:"redo",tabRaccourcis:[{ctrlKey:!0,key:"y"},{shiftKey:!0,ctrlKey:!0,key:"z"}]},{nType:1,sSuf:"COF",sCom:"BackColor",sSty:"backgroundColor"},{nType:1,sSuf:"COL",sCom:"ForeColor",sSty:"color"},{nType:2,sSuf:"LNK",sCom:"OnLink"},{nType:2,sSuf:"IMG",sCom:"OnImage"},{nType:2,sSuf:"COD",sCom:"OnAfficheCodeSourceHTML"},{nType:3,sSuf:"FNA",sCom:"FontName",sSty:"fontFamily",bAvecSaisie:!0,tabP:[{sN:"Arial",sV:"Arial"},{sN:"Courier",sV:"Courier New"},{sN:"Geneva",sV:"Geneva"},{sN:"Georgia",sV:"Georgia"},{sN:"Helvetica",sV:"Helvetica"},{sN:"Tahoma",sV:"Tahoma"},{sN:"Times New Roman",sV:"Times New Roman"},{sN:"Verdana",sV:"Verdana"}]},{nType:3,sSuf:"FSI",sCom:"FontSize",sSty:"fontSize",bAvecSaisie:!0,tabP:[{sN:"1",sV:"1"},{sN:"2",sV:"2"},{sN:"3",sV:"3",bMasquerEnRelookUL:!0},{sN:"4",sV:"4"},{sN:"5",sV:"5",bMasquerEnRelookUL:!0},{sN:"6",sV:"6"},{sN:"7",sV:"7",bMasquerEnRelookUL:!0}]},{nType:3,sSuf:"FHE",sCom:"FormatBlock",sSty:"",bAvecSaisie:!1,tabP:[{sN:"div",sV:"&lt;div&gt;"},{sN:"h1",sV:"&lt;h1&gt;"},{sN:"h2",sV:"&lt;h2&gt;"},{sN:"h3",sV:"&lt;h3&gt;"},{sN:"h4",sV:"&lt;h4&gt;"},{sN:"h5",sV:"&lt;h5&gt;"},{sN:"h6",sV:"&lt;h6&gt;"},{sN:"pre",sV:"&lt;pre&gt;"}]},{nType:3,sSuf:"EMO",sCom:"wbEmoji",tabP:a,nIndiceSelectionDefaut:9},{nType:1,sSuf:"TAB",sCom:"wbInsertTable"}],n.prototype.sGetCouleurFond=function(){return""},n.prototype.Init=function(){this.__InitInterne(arguments)},n.prototype._vLiaisonHTML=function(){WDBarre.prototype._vLiaisonHTML.apply(this,arguments);this.ms_tagBoutonClic="i"},n.prototype.__InitInterne=function(n,t){var i=!!n||t;i||this.__Uninit();this.__Init1(i);i&&WDBarre.prototype.Init.apply(this,n);this.__Init2(i)},n.prototype.__Init1=function(n){if(!this.oGetTableZRParent()){if(this.m_oValeur=this.oGetElementByIdZR(document,""),this._vLiaisonHTML(),n&&this.m_oHote){var t=this.m_oHote.attributes.getNamedItem("TABINDEX");t&&(this.m_sTabIndex=t.nodeValue,this.m_oHote.removeAttribute("TABINDEX",0))}this.__InitCommun()}},n.prototype.__Uninit1=function(){this.oGetTableZRParent()||(this.__UninitCommun(),this.m_oHote&&(this.__AppliqueHoteStyleBordure(this.m_oHote),delete this.m_oHoteStyleBordure,clWDUtil.SupprimeFils(this.m_oHote)),this.m_oHote=null,delete this.m_oHote,this.m_oValeur=null,delete this.m_oValeur)},n.prototype.__Init2=function(n){this.bGestionTableZR()&&this.DeplaceBarre(this.oGetElementByIdZRIndice(document,this.nGetTableZRValeur(),this.ms_sSuffixeCommande));this.__InitHookDocumentBarre();this.m_oData&&this.m_oValeur&&this.__EcraseContenu(this.m_oValeur.value);this.RafBarre(null);this.__InitSpecifique(n)},n.prototype.__Uninit2=function(){this.__UninitSpecifique();this.__UnhookDocumentBarre()},n.prototype.__Uninit=function(){this.oGetTableZRParent()||(this.__Uninit2(),this.__Uninit1())},n.prototype.SetEtat=function(){WDBarre.prototype.SetEtat.apply(this,arguments);this.__ActiveModeEditable()},n.prototype.__ActiveModeEditable=function(){var i,n,t;switch(this.eGetEtat()){default:case WDChamp.prototype.ms_eEtatActif:i=!0;n="on";t="";break;case WDChamp.prototype.ms_eEtatLectureSeule:i=!1;n="off";t="";break;case WDChamp.prototype.ms_eEtatGrise:i=!1;n="off";t="#E0E0E0"}this.m_oData&&this.m_oDocument&&(this.__SetRegles(clWDUtil.oGetCurrentStyle(this.m_oHote).display!="none"&&n==="on"),this.m_oData.style.backgroundColor=t)},n.prototype.__SetRegles=function(n){this.m_oSaisieAPI.Set_designMode(n)},n.prototype.__ReactiveModeEditable=function(){if(this.m_oHote&&clWDUtil.oGetCurrentStyle(this.m_oHote).display!="none"){this.m_oDocument.designMode="off";switch(this.eGetEtat()){default:case WDChamp.prototype.ms_eEtatActif:this.__SetRegles(!0);break;case WDChamp.prototype.ms_eEtatLectureSeule:case WDChamp.prototype.ms_eEtatGrise:}}},n.prototype.__InitCommun=function(){this.bGestionTableZR()?this.__InitCommunZR():this.__InitCommunIFrame()},n.prototype.__InitCommunIFrame=function(){var t,v,w,b,o,f,k,s,d,a,rt,g,ut;if(this.m_oHote){t=document.createElement("iframe");t.id=this.sGetNomElement(h);t.src='javascript:""';this.__OnResize(null,t);t.frameBorder="0";t.border="0";this.m_sTabIndex&&(t.tabIndex=this.m_sTabIndex);clWDUtil.SupprimeFils(this.m_oHote);this.m_oIFrame=this.m_oHote.appendChild(t);this.m_oDocument=this.m_oIFrame.contentWindow.document;t.style.resize="none";t.style.verticalAlign="top";this.m_oHote.style.height.indexOf("%")==-1&&(t.style.minHeight=this.m_oHote.style.height,this.m_oHote.style.minHeight=this.m_oHote.style.height);this.m_jqGrip=$('<div class="wbSaisieRicheGrip"><\/div>');$(this.m_oHote).append(this.m_jqGrip);v=function(n){var i=$(this.m_oIFrame).height(),r=n.screenY,t=$(document.body).add(this.m_oDocument.body).add(window).on("mousemove.wb.saisieriche.grip.pendant",function(n){$(this.m_oIFrame).add(this.m_oIFrame.parentElement).css("height",i+n.screenY-r);this._vOnResize(n);n.stopPropagation();n.preventDefault();this._DeplaceBarre()}.bind(this)).on("mouseup.wb.saisieriche.grip.fin",function(){t.off("mousemove.wb.saisieriche.grip.pendant");t.off("mouseup.wb.saisieriche.grip.fin");this.m_jqGrip.one("mousedown.wb.saisieriche.grip.debut",v)}.bind(this))}.bind(this);this.m_jqGrip.one("mousedown.wb.saisieriche.grip.debut",v);$(window).on("trigger.wb.postUpdateLayoutSuperposableEpingle",function(n){this._vOnResize(n)}.bind(this));var nt=this,n=[],y=[],p=[],tt=_WD_;if(clWDUtil.bHTML5){if(n.push("<!DOCTYPE html>"),$("link").filter(function(){return this.href&&this.href.indexOf(".css")>-1&&(!nt.m_bModeSansStyleWB||this.href.indexOf("static.css")>-1)}).each(function(){p.push(this.cloneNode(!0))}),$("script").filter(function(){return this.src&&(this.src.indexOf("WDUtil.js")!=-1||this.src.indexOf("WDEditeurImage")!=-1||this.src.indexOf("WWConstante")!=-1||this.src.indexOf("jquery.js")!=-1||this.src.indexOf("jquery-3.js")!=-1||this.src.indexOf("jquery-ui.js")!=-1)}).each(function(){var n;(n=this.src.indexOf("res/WDUtil.js"))!=-1&&(tt=this.src.substr(0,n));y.push(this)}),this.m_oBarre){var e=getComputedStyle(this.m_oBarre),i=clWDUtil.tabHTML2RVBA(e.color),it="rgba("+i[0]+", "+i[1]+", "+i[2]+", 0.15)",ft="rgba("+i[0]+", "+i[1]+", "+i[2]+", 0.25)";document.head.appendChild($("<style id='wbSaisieRicheStyle-"+this.m_oBarre.id+"'>#"+this.m_oBarre.id+" .wbBarreOutilsLi:hover, .wbBarreOutilsComboListeOption:hover{background-color:"+it+";}#"+this.m_oBarre.id+" .wbBarreOutilsLi.wbActif, #"+this.m_oBarre.id+" .wbBarreOutilComboCheckbox:checked+.wbBarreOutilComboLabelReplie>* {background-color:"+ft+";}#"+this.m_oBarre.id+" .wbBarreOutilsLi:not([id])+.wbBarreOutilsLi:not([id])>label>* { border-left: 1px solid "+e.borderColor+"; }}<\/style>").get(0));p.push($("<style>.wbSaisieRicheBarre{ background-color:"+e.backgroundColor+";border-color:"+e.borderColor+";}.wbBarreOutilsMiniBarreLi:hover{background-color:"+it+";}<\/style>").get(0))}}else n.push('<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">');for(n.push(clWDUtil.bRTL?'<html dir="rtl">':"<html>"),n.push('<head xmlns="http://www.w3.org/1999/xhtml">'),n.push('<style type="text/css">body{margin:0;padding:2px;overflow:auto;}html{height: 100%;overflow:hidden;}body{height:100%;box-sizing:border-box !important;}'),w=clWDUtil.sGetCSSTexte("#"+this.m_oHote.id+" p"),""!=w&&(n.push("p{"),n.push(w),n.push("}")),n.push("<\/style>"),n.push('<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><base target="_blank" /><base href="'),n.push(tt),n.push('" />'),b=n.join(""),b+="<\/head><body><\/body><\/html>",this.m_oSaisieAPI=new WDSaisieAPI(!0,this.m_oIFrame,{domStyleCommun:p,bEnModeMail:this.m_bModeEmail,innerHTML:b,bGestionImages:!0,bGestionLiens:!0,bGestionTables:!0,onTab:function(n){$(nt.m_oIFrame).emulateTab(n?1:-1)}}),this.m_oData=this.m_oDocument.body,this.m_oDocument.documentElement.wdSaisieRiche=this,o=0;o<y.length;++o)f=document.createElement("script"),f.async=!1,f.defer=!1,f.src=y[o].src,this.m_oDocument.head.appendChild(f);if(k=clWDUtil.oGetCurrentStyle(this.m_oHote),s={},r(k,c,s,!1),r(k,l,s,!0),this.m_oHoteStyleBordure=s,this.__AppliqueHoteStyleBordure(this.m_oData),this.__SupprimeHoteBordurePadding(),this.__CopieStyleBase(),this.m_oValeur)for(d=this.m_oValeur.attributes,rt=d.length,a=0;a<rt;a++){var et=d.item(a),ot=et.name,u=ot.toLowerCase();u.substr(0,2)==="on"&&(u.indexOf("onselect")===0?this.m_oDocument.addEventListener("selectionchange",this.m_oValeur.onselect):(u.indexOf("onmouse")===0||u.indexOf("onkey")===0)&&this.m_oDocument.body.addEventListener(u.substr(2),this.m_oValeur[u]))}window.$&&(g=$(this.m_oIFrame).closest(".wbLibChamp"+this.m_sAliasChamp),g.length&&g.trigger("trigger.wb.saisie.rwd.riche",this.m_oIFrame));window.NSPCS&&(ut=this.m_sAliasChamp,this.m_oData.addEventListener("input",function(){NSPCS.NSChamps.OnInputModification(ut)}))}},n.prototype.__SupprimeHoteBordurePadding=function(){this.m_oHote.clientHeight&&(this.m_oHote.style.border="0px solid transparent",this.m_oHote.style.padding="0px 0px 0px 0px")},n.prototype.__AppliqueHoteStyleBordure=function(n){var t=this.m_oHoteStyleBordure;for(var i in t)t.hasOwnProperty(i)&&(n.style[i]=t[i])},n.prototype.__InitCommunZR=function(){this.PourToutesLignesTableZR(this.__InitCommunZR_CB,this.nGetTableZRValeur())},n.prototype.__InitCommunZR_CB=function(n,t){n!=t?this.__InitCommunZR_HTML(n):this.__InitCommunZR_IFrame(n)},n.prototype.__InitCommunZR_IFrame=function(){this.m_oHote&&this.__InitCommunIFrame()},n.prototype.__InitCommunZR_HTML=function(n){var i=this.oGetElementByIdZRIndice(document,n,""),t=this.oGetElementByIdZRIndice(document,n,this.ms_sSuffixeHote),r;i&&t&&(r=i.attributes.getNamedItem("DISABLED"),t.style.backgroundColor=r&&r.specified?"#E0E0E0":"",t.style.overflow="auto",t.innerHTML=i.value,t.onclick=function(t){this.OnClickLigne(t||event,n)}.bind(this))},n.prototype.__UninitCommun=function(){this.bGestionTableZR()&&this.__UninitCommunZR();this.m_oData=null;delete this.m_oData;this.m_oDocument=null;delete this.m_oDocument;this.m_oIFrame=null;delete this.m_oIFrame},n.prototype.__UninitCommunZR=function(){this.PourToutesLignesTableZR(this.__UninitCommunZR_HTML)},n.prototype.__UninitCommunZR_HTML=function(n){var t=this.oGetElementByIdZRIndice(document,n,this.ms_sSuffixeHote);t&&(clWDUtil.SupprimeFils(t),t.onclick=null)},n.prototype.__InitSpecifique=function(){var t,n,i;this.m_oValeur&&(t=!1,n=this.m_oValeur.attributes.getNamedItem("READONLY"),n&&n.specified&&(WDBarre.prototype.SetEtat.apply(this,[this.ms_eEtatLectureSeule]),t=!0),i=!1,n=this.m_oValeur.attributes.getNamedItem("DISABLED"),n&&n.specified&&(WDBarre.prototype.SetEtat.apply(this,[this.ms_eEtatGrise]),i=!0),t||i||this.ms_eEtatActif==this.eGetEtat()||WDBarre.prototype.SetEtat.apply(this,[this.ms_eEtatActif]));this.__ActiveModeEditable();this.__SetMinHeight();this.m_oDocument&&clWDUtil.AttacheDetacheEvent(!0,this.m_oDocument,"keydown",this.m_fKeyDown)},n.prototype.__UninitSpecifique=function(){this.m_oDocument&&clWDUtil.AttacheDetacheEvent(!1,this.m_oDocument,"keydown",this.m_fKeyDown)},n.prototype.__CopieStyleBase=function(){var f=clWDUtil.oGetCurrentStyle(this.m_oData),t=clWDUtil.oGetCurrentStyle(this.m_oHote),e=this.m_oData.style,n,i,r,u;for(n in t)if((!bFF||!t.hasOwnProperty(n))&&(i=t[n],"string"==typeof i)){if("border"===n.substr(0,6)||"padding"===n.substr(0,7)||"outline"===n||"margin"===n.substr(0,6)||"overflow"===n.substr(0,8)||"width"===n||"height"===n||"cssText"===n||"background"===n||"font"===n||"webkitBorder"===n.substr(0,12)||"webkitPadding"===n.substr(0,13)||"webkitLogical"===n.substr(0,13)||"visibility"===n||"color"===n||"webkitUserModify"===n)continue;else"lineHeight"===n&&(r=parseInt(t.lineHeight),u=parseInt(t.fontSize),isNaN(r)||isNaN(u)||(i=r/u));f[n]!==i&&(e[n]=i)}},n.prototype.__RafBarreMasqueAutre=function(n){return AppelMethode("RafBarre",[n],this),this.RafBarre(n,!0)},n.prototype._InitBarreAutomatique=function(){clWDUtil.AttacheDetacheEvent(!0,document,"click",this.m_fRafBarreSans);clWDUtil.AttacheDetacheEvent(!0,document,"keyup",this.m_fRafBarreSans)},n.prototype.__InitHookDocumentBarre=function(){var n=this.m_oDocument;n&&(clWDUtil.AttacheDetacheEvent(!0,n,"click",this.m_fRafBarreTrueMasqueAutre),clWDUtil.AttacheDetacheEvent(!0,n,"keyup",this.m_fRafBarreTrueMasqueAutre))},n.prototype.__UnhookDocumentBarre=function(){var n=this.m_oDocument;n&&(clWDUtil.AttacheDetacheEvent(!1,n,"click",this.m_fRafBarreTrueMasqueAutre),clWDUtil.AttacheDetacheEvent(!1,n,"keyup",this.m_fRafBarreTrueMasqueAutre))},n.prototype._voNewBoutonOnOff=function(n,t){return new e(this,n,t.sCom,t.sSty,t.tabP)},n.prototype._voNewBoutonPopup=function(n,t){var i=t.sSuf+"P";return new o(this,n,t.sCom,this.oGetElementByIdBarre(document,i),i,t.sSty)},n.prototype._voNewBoutonAction=function(n,t){return new f(this,n,t.sCom)},n.prototype._voNewBoutonCombo=function(n,t){return new s(this,n,t.sCom,t.sSty,t.tabP,t.sSuf,t.bAvecSaisie)},n.prototype._AssocieBarreElements=function(){WDBarre.prototype._AssocieBarreElements.apply(this,arguments);bEdge||$(".wbBarreOutilsImgPlanche").addClass("wbBarreOutilsImgPlancheSVG")},n.prototype.OnClickLigne=function(n,t){this.bSauveContenu(n);this._OnClickLigneRetarde(n,t)},n.prototype._OnClickLigneRetarde=function(n,t){var i=this.oGetTableZRParent();if(i&&i.m_oCache&&i.m_oCache.m_tabRequetes.length>0){this.nSetTimeout(this._OnClickLigneRetarde,clWDUtil.ms_oTimeoutImmediat,null,t);return}this.SetTableZRValeur(n,t);this.__InitInterne()},n.prototype._vOnResize=function(n){if(WDBarre.prototype._vOnResize.apply(this,arguments),this.m_oDocument&&this.m_oHote&&clWDUtil.bEstDisplay(this.m_oHote,document,!0)){this.m_oIFrame&&this.__OnResize(n,this.m_oIFrame);bEdge&&this.__CopieStyleBase();this.__SetMinHeight();var t=this.m_oBarre&&this.m_oBarre.style.opacity!=="0"&&clWDUtil.bEstDisplay(this.m_oBarre,document,!0);t&&this.__RafBarreMasqueAutre(n)}},n.prototype.__SetMinHeight=function(){if((clWDUtil.bHTML5||bFF)&&this.m_oData){(bFF||clWDUtil.bHTML5)&&"100%"==this.m_oHote.parentNode.parentNode.parentNode.parentNode.style.height&&(this.m_oIFrame.style.minHeight="0",this.m_oIFrame.style.minHeight=this.m_oHote.parentNode.offsetHeight-3+"px");this.m_oData.style.minHeight="0";var n=clWDUtil.oGetCurrentStyle(this.m_oData),t=n?this.s_nGetOffsetBorderPourHeight(n):0;this.m_oData.style.minHeight=this.m_oIFrame.offsetHeight-4-t+"px"}},n.prototype.__OnResize=function(n,t){t.style.width="100%";t.style.height="100%"},n.prototype.OnDisplay=function(n,t){if(undefined===this.m_tabBarreElements&&this.Init(),WDBarre.prototype.OnDisplay.apply(this,arguments),!1!==(t&&this.m_oHote&&clWDUtil.bEstFils(this.m_oHote,n))){var i=!0,r=Array.prototype.some.call(n.getElementsByTagName("iframe"),function(n){return this.m_oDocument===n.contentWindow.document}.bind(this));r||(this.__InitInterne(undefined,!0),i=!1);this.m_oHote&&this.__SupprimeHoteBordurePadding();this.m_oDocument&&(this.m_oDocument.body&&(this.m_oDocument.body.style.visibility=""),this.__ReactiveModeEditable());i&&this._vOnResize(null)}},n.prototype._vOnTableZRAfficheAJAXInterne=function(){WDBarre.prototype._vOnTableZRAfficheAJAXInterne.apply(this,arguments);this.__InitInterne()},n.prototype._vOnLigneTableZRAffiche=function(n,t){WDBarre.prototype._vOnLigneTableZRAffiche.apply(this,arguments);var i=this.oGetTableZRParent();t||i&&i.bLigneEstSelectionnee(n-1,NaN)?(this.m_oValeur=this.oGetElementByIdZRIndice(document,n,""),this.m_oHote=this.oGetElementByIdZRIndice(document,n,this.ms_sSuffixeHote),this.__InitCommunZR_IFrame(n-1),this.DeplaceBarre(this.oGetElementByIdZRIndice(document,n,this.ms_sSuffixeCommande)),this.__InitHookDocumentBarre(),this.m_oData&&this.m_oValeur&&this.__EcraseContenu(this.m_oValeur.value),this.RafBarre(null,!1,n),this.__InitSpecifique(!1)):this.__InitCommunZR_HTML(n)},n.prototype._vOnLigneTableZRMasque=function(n,t,i){t&&(this.OnBlur(i,n),this.bSauveContenu(i),this.__UninitSpecifique(),this.__UnhookDocumentBarre());var r=this.oGetElementByIdZRIndice(document,n,this.ms_sSuffixeHote);r&&(t&&(this.__AppliqueHoteStyleBordure(r),delete this.m_oHoteStyleBordure),clWDUtil.SupprimeFils(r),r.onclick=null);t&&(this.m_oData=null,delete this.m_oData,this.m_oDocument=null,delete this.m_oDocument,this.m_oIFrame=null,delete this.m_oIFrame,this.m_oHote=null,delete this.m_oHote,this.m_oValeur=null,delete this.m_oValeur);WDBarre.prototype._vOnLigneTableZRMasque.apply(this,arguments)},n.prototype.RafBarre=function(n,t,i){var r,u,f,e,o;if(t===undefined){if(r=null,n&&(r=clWDUtil.oGetOriginalTarget(n)),!r){r=document.activeElement;try{r.parentNode}catch(s){r=null}}(r===window||clWDUtil.bEstFils(r,this.m_oBarre)||clWDUtil.bEstFils(r,this.m_oHote))&&(t=!0);u=this.oGetTableZRParent();u&&u.m_tabSelection&&u.m_oCache&&(f=u.m_oCache.oGetLigne(u.m_tabSelection[0]),f&&r==f.m_oLigneHTML.oGetLigneLogiqueHTML(f.vnGetColonneHTML())&&(t=!0))}if(t?this.OnFocus(n,i):this.OnBlur(n,i),this.m_oBarre){t&&this.AppelMethodeAutresPtr(WDChamp.prototype.MasqueBarre,[n]);e=t;this.m_eModeBarre!=this.ms_eModeBarreAutomatique&&(t=undefined);this.eGetEtat()!=WDChamp.prototype.ms_eEtatActif&&(t=!1);switch(this.m_eModeBarre){case this.ms_eModeBarreJamais:break;case this.ms_eModeBarreAutomatique:default:if(this.m_oBarre.style.display="block",this.m_oBarre.style.opacity=t?1:0,this.m_oBarre.style.pointerEvents=t?"all":"none",this.m_oBarre.style.position=t?"absolute":"fixed",!t)break;case this.ms_eModeBarreToujours:this._DeplaceBarre();this.m_bBarreDeplacee&&(this.m_oBarre.style.display="block",t=!(!e&&!clWDUtil.bEstDisplay(this.m_oHote,document,!0)),this.m_oBarre.style.opacity=t?1:0,this.m_oBarre.style.pointerEvents=t?"all":"none");o=this.oGetParamEtat(n,!1);this.m_tabBarreElements.forEach(function(t){t.RafEtat(n,o)})}}},n.prototype._DeplaceBarreSiBesoinAvecTimeout=function(){var n=this.m_oBarre&&this.m_oBarre.style.opacity!=="0"&&clWDUtil.bEstDisplay(this.m_oBarre,document,!0);this.m_bBarreDeplacee&&n&&this.m_oHote&&clWDUtil.bEstDisplay(this.m_oHote,document,!0)&&this._DeplaceBarre()},n.prototype._DeplaceBarre=function(){var n,f,e,r,u,t,i;if(this.m_oBarre&&this.m_oHote&&this.m_bBarreDeplacee){n={};n.top="auto";n.left="auto";n.marginTop=0;f=$(this.m_oHote).closest(".dzSpanRiche,.dzSpan,.dzSpanRiche>span,.dzSpan>span");f.length?(this.m_oBarre.parentElement!=this.m_oHote.parentElement&&(e=$(this.m_oBarre).detach(),$(this.m_oHote.parentElement).css("position","relative").prepend(e)),n.marginTop=parseInt(this.m_oData.style.borderTopWidth),n.marginTop&&(n.marginTop+="px"),n.transform="translateY(-100%)",n.width="100%"):this.m_oHote&&this.m_oData&&(n.left=clWDUtil.nGetBoundingClientRectLeft(this.m_oHote,!0)+"px",n.width=this.m_oHote.getBoundingClientRect().width+"px",r=document.body.getBoundingClientRect().height,u=r-clWDUtil.nGetBoundingClientRectTop(this.m_oHote,!0)-(parseInt(this.m_oData.style.borderTopWidth)+1),n.bottom=u+"px",bTouchMobile||(this.m_oBarre.style.width=n.width,t=u,t=Math.min(t,r-$(window).scrollTop()-this.m_oBarre.clientHeight),t=Math.max(t,r-($(this.m_oHote).offset().top+this.m_oHote.clientHeight)),n.transform="translateY("+(u-t)+"px)"),this.rafDeplaceBarre&&cancelAnimationFrame(this.rafDeplaceBarre));for(i in n)this.m_oDernierePositionBarre&&this.m_oDernierePositionBarre[i]==n[i]||(this.m_oBarre.style[i]=n[i]);this.m_oDernierePositionBarre=n}},n.prototype.__ExecutePCodeAvecLigneTableZR=function(n,t,i){var u,r,f,e;undefined!==i&&(f=this.oGetTableZRParent(),f&&(u=window["_GET_"+f.m_sAliasChamp+"_1"],r=window["_SET_"+f.m_sAliasChamp+"_1"]));u&&r&&(e=u(),r(i));try{this.RecuperePCode(n)(t)}finally{u&&r&&r(e)}},n.prototype.OnFocus=function(n,t){this.m_bFocus||(this.m_bFocus=!0,this.__ExecutePCodeAvecLigneTableZR(this.ms_nEventNavFocus,n,t))},n.prototype.OnBlur=function(n,t){this.m_bFocus&&(this.__SauveContenuAvecOnChange(n),this.__ExecutePCodeAvecLigneTableZR(this.ms_nEventNavBlur,n,t),delete this.m_bFocus)},n.prototype.__SauveContenuAvecOnChange=function(n){if(this.bSauveContenu(n)){var t=this.RecuperePCode(this.ms_nEventNavChange);t!=clWDUtil.m_pfVide&&t(n)}},n.prototype.bOnKeyDown=function(n){var u,f,t,s,r,h,i,e,o;if(n.keyCode==13)bEdge&&this.m_bBaliseP?(u=this.oGetRange(),u&&(f=u.startContainer,f&&f==u.endContainer&&(t=f.nextSibling,t&&clWDUtil.bBaliseEstTag(t,"br")&&!t.nextSibling&&t.parentNode.removeChild(t)))):bFF&&this.m_bBaliseP?this.m_oDocument.execCommand("formatBlock",!1,"p"):bCrm&&this.m_bBaliseP&&(s=this.m_oDocument.body.childNodes,1==s.length&&s[0].nodeName=="#text"&&this.m_oDocument.execCommand("formatBlock",!1,"p"));else for(h=this.m_tabDescBarre.length,r=0;r<h;r++)if(i=this.m_tabDescBarre[r],i&&i.tabRaccourcis&&i.tabRaccourcis.length)for(e=0;e<i.tabRaccourcis.length;++e)if(o=i.tabRaccourcis[e],n.ctrlKey===!!o.ctrlKey&&n.shiftKey===!!o.shiftKey&&n.key===o.key){this.m_tabBarreElements[r].m_oBouton.onclick(n);n.stopPropagation();n.preventDefault()}return!0},n.prototype.oGetParamEtat=function(n,t){if(this.bGestionTableZR()&&!this.m_oDocument)return[null,null,null];var i=[this.oGetRange(),null,null];return t||(i[1]=this.oGetSelection(i[0]),i[2]=i[1]&&this.m_oDocument!==i[1]?clWDUtil.oGetCurrentStyle(i[1]):null),i},n.prototype.__oGetSelection=function(){var n=this.m_oDocument,t=n.defaultView;return t&&t.getSelection?t.getSelection():n.getSelection?n.getSelection():undefined},n.prototype.oGetRange=function(){var n=this.__oGetSelection();return n&&n.rangeCount?n.getRangeAt(0):null},n.prototype.oGetRangeCpy=function(){var n=this.oGetRange();return n&&n.cloneRange(),null},n.prototype.oGetSelection=function(n){return n?n.startContainer:null},n.prototype.OptimiseContenu=function(){},n.prototype.__EcraseContenu=function(n){var i,t;this.m_fTermineAffichageCodeSourceHTML&&(i=!0,this.m_fTermineAffichageCodeSourceHTML(),this.m_fTermineAffichageCodeSourceHTML=undefined);this.m_oSaisieAPI&&this.m_oSaisieAPI.SetProp_ValeurBodyInner?this.m_oSaisieAPI.SetProp_ValeurBodyInner(n):this.m_oData.innerHTML=n;i&&this.__OnAfficheCodeSourceHTML();window.$&&(t=$(this.m_oIFrame).closest(".wbLibChamp"+this.m_sAliasChamp),t.length&&t.trigger("trigger.wb.saisie.rwd.valeurinitDepuisConteneur"))},n.prototype.bSauveContenu=function(n){var r=!1,i,t;return this.m_oValeur&&(this.OptimiseContenu(),i=this.m_oValeur.value,t=this.m_oSaisieAPI&&this.m_oSaisieAPI.GetProp_ValeurBodyInner?this.m_oSaisieAPI.GetProp_ValeurBodyInner():this.m_oData.innerHTML,this.m_oValeur.value=t,r=i!=t,i.toUpperCase()!=t.toUpperCase()&&this._OnChampModifie(n,t)),r},n.prototype.SetValeur=function(n,t){return WDBarre.prototype.SetValeur.apply(this,arguments),this.__EcraseContenu(t),this.bSauveContenu(),this.__ReactiveModeEditable(),this.m_oValeur.value},n.prototype.GetValeur=function(){return this.bSauveContenu(),this.m_oValeur.value},n.prototype.GetProp=function(n){switch(n){case this.XML_CHAMP_PROP_NUM_TEXTESANSFORMAT:return this.m_oData?this.m_oData.innerText:"";default:return WDBarre.prototype.GetProp.apply(this,arguments)}},n.prototype.SetProp=function(n,t,i){i=WDBarre.prototype.SetProp.apply(this,arguments);switch(n){case this.XML_CHAMP_PROP_NUM_COULEUR:return this.m_oDocument.body.style.color=i,i;case this.XML_CHAMP_PROP_NUM_COULEURFOND:return this.m_oDocument.body.style.backgroundColor=i,i;case this.XML_CHAMP_PROP_NUM_ETAT:return this.__InitSpecifique(!1),i;default:return i}},n.prototype.OnSubmit=function(n){WDBarre.prototype.OnSubmit.apply(this,arguments);this.__SauveContenuAvecOnChange(n)},n.prototype.SetFocus=function(){this.m_oIFrame.contentWindow.focus();this.m_oData.focus();this.RafBarre(null)},n.prototype.AjouteTable=function(n){for(var i,t='<br /><table align="center" width="80%" style="border-collapse:collapse;table-layout:fixed;">',r=0;r<n[2][1];++r){for(t+="<tr>",i=0;i<n[2][0];++i)t+='<td style="border:1px solid #808080;"><br /><\/td>';t+="<\/tr>"}t+="<\/table><br />";this.m_oSaisieAPI.CMD_InsereTableauHTML(t,n[3])},n.prototype.AjouteEmoji=function(n){this.m_oSaisieAPI.CMD_InsereHtml(n[2],!0)},n.prototype.ExecuteCommande=function(n,t){this.SetFocus();switch(t[0]){case"bold":this.m_oSaisieAPI.CMD_Gras();break;case"italic":this.m_oSaisieAPI.CMD_Italique();break;case"underline":this.m_oSaisieAPI.CMD_Souligne();break;case"strikeThrough":this.m_oSaisieAPI.CMD_Barre();break;case"JustifyLeft":this.m_oSaisieAPI.CMD_AligneGauche();break;case"JustifyCenter":this.m_oSaisieAPI.CMD_AligneCentre();break;case"JustifyRight":this.m_oSaisieAPI.CMD_AligneDroite();break;case"JustifyFull":this.m_oSaisieAPI.CMD_AligneJustifie();break;case"InsertOrderedList":this.m_oSaisieAPI.CMD_CreePuceAvecNumero();break;case"InsertUnorderedList":this.m_oSaisieAPI.CMD_CreePuceSansNumero();break;case"Outdent":this.m_oSaisieAPI.CMD_DiminueRetrait();break;case"Indent":this.m_oSaisieAPI.CMD_AugmenteRetrait();break;case"superscript":this.m_oSaisieAPI.CMD_Exposant();break;case"subscript":this.m_oSaisieAPI.CMD_Indice();break;case"undo":this.m_oSaisieAPI.CMD_Annuler();break;case"redo":this.m_oSaisieAPI.CMD_Retablir();break;case"BackColor":this.m_oSaisieAPI.CMD_ChangeCouleurFondTexte(t[2]);break;case"ForeColor":this.m_oSaisieAPI.CMD_ChangeCouleurTexte(t[2]);break;case"FontName":this.m_oSaisieAPI.CMD_ChangeNomPolice(t[2]);break;case"FontSize":var i=t[2];if(i.length&&!isNaN(parseInt(i[i.length-1])))switch(i){case"1":i="10px";break;case"2":i="13px";break;case"4":i="18px";break;case"6":i="32px";break;default:i+="px"}this.m_oSaisieAPI.CMD_ChangeTaillePolice(i);break;case"FormatBlock":this.m_oSaisieAPI.CMD_ChangeFormatBlock(t[2]);break;case"wbInsertTable":this.AjouteTable(t);break;case"wbEmoji":this.AjouteEmoji(t);break;default:t[0]==="FormatBlock"&&typeof t[2]=="string"&&(t[2]=t[2].replace("&lt;","<").replace("&gt;",">"));this.m_oDocument.execCommand(t[0],t[1],t[2])}this.SetFocus();this.RafBarre(n,!0)},n.prototype.OnLink=function(n){this.__OnPrompt(n,"CreateLink",HTML_TOOLBAR.DLG.LNK||"URL ?","http://",!1,!0)},n.prototype.OnImage=function(n){var t=this.oGetRange(),i=function(n){var i,r,u;n&&(t&&t.item&&t.item(0).src?t.item(0).src=n:(i=document.createElement("img"),i.src=n,i.style.margin="24px",t?(t.deleteContents(),t.insertNode(i),t.collapse()):(r=this.m_oIFrame.contentWindow.getSelection(),r.anchorNode?(u=r.getRangeAt(0),u.deleteContents(),u.insertNode(i)):this.m_oIFrame.contentWindow.document.body.appendChild(i))),this.m_oSaisieAPI.NotifieApresModification())}.bind(this);n.stopPropagation();this.m_oSaisieAPI.ExecuteEditeurImage(function(){var n=window.wbEditeurImageSelectImage({onOK:function(n){n&&i(n)},onComponentDidMount:function(){$(n).hide().fadeIn().focus()}});this.m_oDocument.documentElement.wdSaisieRiche.RafBarre(undefined,!1)}.bind(this),function(){i(prompt(HTML_TOOLBAR.DLG.IMG||"Image ?","http://"))}.bind(this))},n.prototype.OnAfficheCodeSourceHTML=function(n){n.stopPropagation();$(this.m_oBarre).find(".wbActif").removeClass("wbActif");var t=$(n.target).add(n.target.parentElement).add(n.target.parentElement.parentElement),i=$(this.m_oBarre).children().not(t),r=i.add(i.find("i,label"));if(this.m_fTermineAffichageCodeSourceHTML){this.m_fTermineAffichageCodeSourceHTML();this.m_fTermineAffichageCodeSourceHTML=undefined;this.m_fRetourAuWysiwyg&&(this.m_fRetourAuWysiwyg(),this.m_fRetourAuWysiwyg=undefined);return}t.addClass("wbActif");r.addClass("wbgrise");this.m_fRetourAuWysiwyg=function(){r.removeClass("wbgrise");this.m_oIFrame.style.opacity=1;this.m_oIFrame.style.pointerEvents="auto";this.m_valeurCodeHTML!==undefined&&(this.m_oData.innerHTML=this.m_valeurCodeHTML);this.m_valeurCodeHTML=undefined};this.__OnAfficheCodeSourceHTML()},n.prototype.__OnAfficheCodeSourceHTML=function(){this.m_oIFrame.style.opacity=.5;this.m_oIFrame.style.pointerEvents="none";var n=document.createElement("div");n.style.opacity=0;n.style.pointerEvents="none";n.style.position="absolute";n.style.height="100%";n.style.width="100%";n.style.top=0;n.style.left=0;n.style.display="flex";n.style.flexDirection="column";n.addEventListener("click",function(){$(this).find("[contenteditable]").focus()});this.m_oIFrame.parentElement.style.position="relative";this.m_oIFrame.parentElement.append(n);this.m_oSaisieAPI.ExecuteEditeurImage(function(){this.m_fTermineAffichageCodeSourceHTML=window.wbEditeurCode({domEditeurCode:n,value:this.m_oData.innerHTML,onChange:function(n){this.m_valeurCodeHTML=n}.bind(this),onComponentDidMount:function(){this.m_oIFrame.style.opacity=0;n.style.pointerEvents="auto";n.style.opacity=1}.bind(this)})}.bind(this),function(){this.m_fRetourAuWysiwyg&&(this.m_fRetourAuWysiwyg(),this.m_fRetourAuWysiwyg=undefined)}.bind(this))},n.prototype.__OnPrompt=function(n,t,i,r,u,f){var e=prompt(i,r),h,c,o,s;e&&e!=r&&(f&&(h=this.oGetRange(),h.collapsed&&(c=this.m_oIFrame.contentWindow.getSelection(),o=c.getRangeAt(0),o.deleteContents(),s=document.createElement("span"),s.innerText=e,o.insertNode(s))),this.ExecuteCommande(n,[t,!1,e]))},n.prototype.sGetAltText=function(n){return HTML_TOOLBAR.ALTTEXT[n]},n.prototype.RAZIndication=clWDUtil.m_pfVide,n}()